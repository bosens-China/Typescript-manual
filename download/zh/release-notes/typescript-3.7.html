<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>TypeScript 3.7 | TypeScript手册</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/Typescript-manual/favicon.png">
    <meta name="description" content="TypeScript是JavaScript类型的超集，它可以编译成纯JavaScript。
  TypeScript可以在任何浏览器、任何计算机和任何操作系统上运行，并且是开源的。">
    <meta name="viewport" content="width=device-width, initial-scale=1.0,user-scalable=no, viewport-fit=cover">
    <meta name="keywords" content="typescript,docs,手册,文档">
    <meta name="author" content="boses">
    <meta name="google" content="notranslate">
    
    <link rel="preload" href="/Typescript-manual/assets/css/0.styles.237d6e09.css" as="style"><link rel="preload" href="/Typescript-manual/assets/js/app.1593970b.js" as="script"><link rel="preload" href="/Typescript-manual/assets/js/2.f0d70486.js" as="script"><link rel="preload" href="/Typescript-manual/assets/js/1.93812fe5.js" as="script"><link rel="preload" href="/Typescript-manual/assets/js/147.ac8ef52d.js" as="script"><link rel="prefetch" href="/Typescript-manual/assets/js/10.4762e221.js"><link rel="prefetch" href="/Typescript-manual/assets/js/100.d9e46ceb.js"><link rel="prefetch" href="/Typescript-manual/assets/js/101.b135bd55.js"><link rel="prefetch" href="/Typescript-manual/assets/js/102.eb03502d.js"><link rel="prefetch" href="/Typescript-manual/assets/js/103.6d45baa7.js"><link rel="prefetch" href="/Typescript-manual/assets/js/104.9282c1ea.js"><link rel="prefetch" href="/Typescript-manual/assets/js/105.7c026097.js"><link rel="prefetch" href="/Typescript-manual/assets/js/106.1a54e046.js"><link rel="prefetch" href="/Typescript-manual/assets/js/107.c7455d6c.js"><link rel="prefetch" href="/Typescript-manual/assets/js/108.9910413b.js"><link rel="prefetch" href="/Typescript-manual/assets/js/109.7326eb25.js"><link rel="prefetch" href="/Typescript-manual/assets/js/11.87c69216.js"><link rel="prefetch" href="/Typescript-manual/assets/js/110.cc92b634.js"><link rel="prefetch" href="/Typescript-manual/assets/js/111.040b77ba.js"><link rel="prefetch" href="/Typescript-manual/assets/js/112.e6fe143c.js"><link rel="prefetch" href="/Typescript-manual/assets/js/113.ae192573.js"><link rel="prefetch" href="/Typescript-manual/assets/js/114.fb65c1e1.js"><link rel="prefetch" href="/Typescript-manual/assets/js/115.c01cfbd6.js"><link rel="prefetch" href="/Typescript-manual/assets/js/116.02c6ca5f.js"><link rel="prefetch" href="/Typescript-manual/assets/js/117.66129e9d.js"><link rel="prefetch" href="/Typescript-manual/assets/js/118.6a1c9db2.js"><link rel="prefetch" href="/Typescript-manual/assets/js/119.e744a988.js"><link rel="prefetch" href="/Typescript-manual/assets/js/12.4babe899.js"><link rel="prefetch" href="/Typescript-manual/assets/js/120.795aa6be.js"><link rel="prefetch" href="/Typescript-manual/assets/js/121.577dd2ed.js"><link rel="prefetch" href="/Typescript-manual/assets/js/122.287b1f13.js"><link rel="prefetch" href="/Typescript-manual/assets/js/123.8043a050.js"><link rel="prefetch" href="/Typescript-manual/assets/js/124.7c6f56cf.js"><link rel="prefetch" href="/Typescript-manual/assets/js/125.c8a9a013.js"><link rel="prefetch" href="/Typescript-manual/assets/js/126.e64eccdd.js"><link rel="prefetch" href="/Typescript-manual/assets/js/127.3029a53e.js"><link rel="prefetch" href="/Typescript-manual/assets/js/128.654e2397.js"><link rel="prefetch" href="/Typescript-manual/assets/js/129.cb4fc6c0.js"><link rel="prefetch" href="/Typescript-manual/assets/js/13.5ab5050a.js"><link rel="prefetch" href="/Typescript-manual/assets/js/130.c6b9a006.js"><link rel="prefetch" href="/Typescript-manual/assets/js/131.1cebdbee.js"><link rel="prefetch" href="/Typescript-manual/assets/js/132.2620ecb5.js"><link rel="prefetch" href="/Typescript-manual/assets/js/133.7f53bf1f.js"><link rel="prefetch" href="/Typescript-manual/assets/js/134.129702c6.js"><link rel="prefetch" href="/Typescript-manual/assets/js/135.8f4d5357.js"><link rel="prefetch" href="/Typescript-manual/assets/js/136.e17df536.js"><link rel="prefetch" href="/Typescript-manual/assets/js/137.ff13fde2.js"><link rel="prefetch" href="/Typescript-manual/assets/js/138.fb3636c3.js"><link rel="prefetch" href="/Typescript-manual/assets/js/139.f8beedc3.js"><link rel="prefetch" href="/Typescript-manual/assets/js/14.7a250a11.js"><link rel="prefetch" href="/Typescript-manual/assets/js/140.3daa1308.js"><link rel="prefetch" href="/Typescript-manual/assets/js/141.bb090054.js"><link rel="prefetch" href="/Typescript-manual/assets/js/142.fed938ad.js"><link rel="prefetch" href="/Typescript-manual/assets/js/143.a3b29462.js"><link rel="prefetch" href="/Typescript-manual/assets/js/144.c09dd4b2.js"><link rel="prefetch" href="/Typescript-manual/assets/js/145.ffc8125a.js"><link rel="prefetch" href="/Typescript-manual/assets/js/146.743057fc.js"><link rel="prefetch" href="/Typescript-manual/assets/js/148.6d5e8ae5.js"><link rel="prefetch" href="/Typescript-manual/assets/js/149.341c6a4f.js"><link rel="prefetch" href="/Typescript-manual/assets/js/15.fd694870.js"><link rel="prefetch" href="/Typescript-manual/assets/js/150.31a051f2.js"><link rel="prefetch" href="/Typescript-manual/assets/js/151.a761bf9b.js"><link rel="prefetch" href="/Typescript-manual/assets/js/152.32ee780e.js"><link rel="prefetch" href="/Typescript-manual/assets/js/153.1e2f2b44.js"><link rel="prefetch" href="/Typescript-manual/assets/js/154.bc25bc22.js"><link rel="prefetch" href="/Typescript-manual/assets/js/155.fb17da55.js"><link rel="prefetch" href="/Typescript-manual/assets/js/156.651a9c2e.js"><link rel="prefetch" href="/Typescript-manual/assets/js/157.adca0669.js"><link rel="prefetch" href="/Typescript-manual/assets/js/158.a3abc67d.js"><link rel="prefetch" href="/Typescript-manual/assets/js/159.c2445408.js"><link rel="prefetch" href="/Typescript-manual/assets/js/16.a882cd43.js"><link rel="prefetch" href="/Typescript-manual/assets/js/160.c6a27367.js"><link rel="prefetch" href="/Typescript-manual/assets/js/161.b312e41a.js"><link rel="prefetch" href="/Typescript-manual/assets/js/162.3287bbbd.js"><link rel="prefetch" href="/Typescript-manual/assets/js/163.47be0007.js"><link rel="prefetch" href="/Typescript-manual/assets/js/164.210d1a22.js"><link rel="prefetch" href="/Typescript-manual/assets/js/165.7482c1f3.js"><link rel="prefetch" href="/Typescript-manual/assets/js/166.45c6e113.js"><link rel="prefetch" href="/Typescript-manual/assets/js/167.2eebcd57.js"><link rel="prefetch" href="/Typescript-manual/assets/js/168.b3d23364.js"><link rel="prefetch" href="/Typescript-manual/assets/js/169.c924ff86.js"><link rel="prefetch" href="/Typescript-manual/assets/js/17.76d6950f.js"><link rel="prefetch" href="/Typescript-manual/assets/js/170.03ef2fa9.js"><link rel="prefetch" href="/Typescript-manual/assets/js/171.34187668.js"><link rel="prefetch" href="/Typescript-manual/assets/js/172.635bb738.js"><link rel="prefetch" href="/Typescript-manual/assets/js/173.6bbe41b6.js"><link rel="prefetch" href="/Typescript-manual/assets/js/174.e442febc.js"><link rel="prefetch" href="/Typescript-manual/assets/js/175.41bb67ab.js"><link rel="prefetch" href="/Typescript-manual/assets/js/176.49120c59.js"><link rel="prefetch" href="/Typescript-manual/assets/js/177.c523f572.js"><link rel="prefetch" href="/Typescript-manual/assets/js/178.9423ebb2.js"><link rel="prefetch" href="/Typescript-manual/assets/js/179.dda7f960.js"><link rel="prefetch" href="/Typescript-manual/assets/js/18.cac3cb70.js"><link rel="prefetch" href="/Typescript-manual/assets/js/180.4dfba409.js"><link rel="prefetch" href="/Typescript-manual/assets/js/181.e4f017a7.js"><link rel="prefetch" href="/Typescript-manual/assets/js/182.547e085d.js"><link rel="prefetch" href="/Typescript-manual/assets/js/183.5acbdd59.js"><link rel="prefetch" href="/Typescript-manual/assets/js/19.04e9bc02.js"><link rel="prefetch" href="/Typescript-manual/assets/js/20.68aa1956.js"><link rel="prefetch" href="/Typescript-manual/assets/js/21.d9e46a4f.js"><link rel="prefetch" href="/Typescript-manual/assets/js/22.f23e5600.js"><link rel="prefetch" href="/Typescript-manual/assets/js/23.1a6c395d.js"><link rel="prefetch" href="/Typescript-manual/assets/js/24.c4122643.js"><link rel="prefetch" href="/Typescript-manual/assets/js/25.25881907.js"><link rel="prefetch" href="/Typescript-manual/assets/js/26.b5d956b1.js"><link rel="prefetch" href="/Typescript-manual/assets/js/27.ee846739.js"><link rel="prefetch" href="/Typescript-manual/assets/js/28.ba1574f7.js"><link rel="prefetch" href="/Typescript-manual/assets/js/29.32e60931.js"><link rel="prefetch" href="/Typescript-manual/assets/js/3.c0ad6938.js"><link rel="prefetch" href="/Typescript-manual/assets/js/30.3b6cd0b7.js"><link rel="prefetch" href="/Typescript-manual/assets/js/31.0a11a38c.js"><link rel="prefetch" href="/Typescript-manual/assets/js/32.f159c8e6.js"><link rel="prefetch" href="/Typescript-manual/assets/js/33.1ef243d1.js"><link rel="prefetch" href="/Typescript-manual/assets/js/34.f01c876d.js"><link rel="prefetch" href="/Typescript-manual/assets/js/35.8bfdb28b.js"><link rel="prefetch" href="/Typescript-manual/assets/js/36.fdd0ba51.js"><link rel="prefetch" href="/Typescript-manual/assets/js/37.3f218ce6.js"><link rel="prefetch" href="/Typescript-manual/assets/js/38.f8226620.js"><link rel="prefetch" href="/Typescript-manual/assets/js/39.e7d5d326.js"><link rel="prefetch" href="/Typescript-manual/assets/js/4.038d7f28.js"><link rel="prefetch" href="/Typescript-manual/assets/js/40.7a4cb0fe.js"><link rel="prefetch" href="/Typescript-manual/assets/js/41.494af996.js"><link rel="prefetch" href="/Typescript-manual/assets/js/42.304eae27.js"><link rel="prefetch" href="/Typescript-manual/assets/js/43.769a064a.js"><link rel="prefetch" href="/Typescript-manual/assets/js/44.9b36658c.js"><link rel="prefetch" href="/Typescript-manual/assets/js/45.1038e1df.js"><link rel="prefetch" href="/Typescript-manual/assets/js/46.65baf8d4.js"><link rel="prefetch" href="/Typescript-manual/assets/js/47.7b66616f.js"><link rel="prefetch" href="/Typescript-manual/assets/js/48.0e91f3a4.js"><link rel="prefetch" href="/Typescript-manual/assets/js/49.b7f1bb44.js"><link rel="prefetch" href="/Typescript-manual/assets/js/5.64774910.js"><link rel="prefetch" href="/Typescript-manual/assets/js/50.045dee0d.js"><link rel="prefetch" href="/Typescript-manual/assets/js/51.f4d25851.js"><link rel="prefetch" href="/Typescript-manual/assets/js/52.488e3de2.js"><link rel="prefetch" href="/Typescript-manual/assets/js/53.24bf50d9.js"><link rel="prefetch" href="/Typescript-manual/assets/js/54.2342813a.js"><link rel="prefetch" href="/Typescript-manual/assets/js/55.ba7136ba.js"><link rel="prefetch" href="/Typescript-manual/assets/js/56.34586136.js"><link rel="prefetch" href="/Typescript-manual/assets/js/57.55444e9b.js"><link rel="prefetch" href="/Typescript-manual/assets/js/58.6e7dd2c6.js"><link rel="prefetch" href="/Typescript-manual/assets/js/59.6907c3e4.js"><link rel="prefetch" href="/Typescript-manual/assets/js/6.cfb80da4.js"><link rel="prefetch" href="/Typescript-manual/assets/js/60.f7c33e9f.js"><link rel="prefetch" href="/Typescript-manual/assets/js/61.d887d15b.js"><link rel="prefetch" href="/Typescript-manual/assets/js/62.eeb4a1af.js"><link rel="prefetch" href="/Typescript-manual/assets/js/63.166ceb13.js"><link rel="prefetch" href="/Typescript-manual/assets/js/64.e5f91c57.js"><link rel="prefetch" href="/Typescript-manual/assets/js/65.f37d6448.js"><link rel="prefetch" href="/Typescript-manual/assets/js/66.67a6098b.js"><link rel="prefetch" href="/Typescript-manual/assets/js/67.98342e87.js"><link rel="prefetch" href="/Typescript-manual/assets/js/68.0eca9faa.js"><link rel="prefetch" href="/Typescript-manual/assets/js/69.accb09f1.js"><link rel="prefetch" href="/Typescript-manual/assets/js/7.3c60c652.js"><link rel="prefetch" href="/Typescript-manual/assets/js/70.df1bb896.js"><link rel="prefetch" href="/Typescript-manual/assets/js/71.65b4584b.js"><link rel="prefetch" href="/Typescript-manual/assets/js/72.5ad16533.js"><link rel="prefetch" href="/Typescript-manual/assets/js/73.222e0f4f.js"><link rel="prefetch" href="/Typescript-manual/assets/js/74.6d364488.js"><link rel="prefetch" href="/Typescript-manual/assets/js/75.f08ef413.js"><link rel="prefetch" href="/Typescript-manual/assets/js/76.06f71fc6.js"><link rel="prefetch" href="/Typescript-manual/assets/js/77.51c40296.js"><link rel="prefetch" href="/Typescript-manual/assets/js/78.e858e4ab.js"><link rel="prefetch" href="/Typescript-manual/assets/js/79.44e29644.js"><link rel="prefetch" href="/Typescript-manual/assets/js/80.b67dcf99.js"><link rel="prefetch" href="/Typescript-manual/assets/js/81.b7cea060.js"><link rel="prefetch" href="/Typescript-manual/assets/js/82.6441a0a3.js"><link rel="prefetch" href="/Typescript-manual/assets/js/83.03f2f860.js"><link rel="prefetch" href="/Typescript-manual/assets/js/84.070382e8.js"><link rel="prefetch" href="/Typescript-manual/assets/js/85.7a10baf5.js"><link rel="prefetch" href="/Typescript-manual/assets/js/86.52448263.js"><link rel="prefetch" href="/Typescript-manual/assets/js/87.3e28b70e.js"><link rel="prefetch" href="/Typescript-manual/assets/js/88.ac603069.js"><link rel="prefetch" href="/Typescript-manual/assets/js/89.d8fc6c9d.js"><link rel="prefetch" href="/Typescript-manual/assets/js/90.061b7bae.js"><link rel="prefetch" href="/Typescript-manual/assets/js/91.085c8066.js"><link rel="prefetch" href="/Typescript-manual/assets/js/92.f91f3791.js"><link rel="prefetch" href="/Typescript-manual/assets/js/93.222df328.js"><link rel="prefetch" href="/Typescript-manual/assets/js/94.a419988b.js"><link rel="prefetch" href="/Typescript-manual/assets/js/95.ab410dec.js"><link rel="prefetch" href="/Typescript-manual/assets/js/96.d094c11b.js"><link rel="prefetch" href="/Typescript-manual/assets/js/97.a32b936b.js"><link rel="prefetch" href="/Typescript-manual/assets/js/98.86d54546.js"><link rel="prefetch" href="/Typescript-manual/assets/js/99.fe0b2436.js"><link rel="prefetch" href="/Typescript-manual/assets/js/vendors~docsearch.8e5b54b3.js">
    <link rel="stylesheet" href="/Typescript-manual/assets/css/0.styles.237d6e09.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/Typescript-manual/" class="home-link router-link-active"><!----> <span class="site-name">TypeScript手册</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/Typescript-manual/describe/" class="nav-link">
  进入目录
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="友情链接菜单" class="dropdown-title"><span class="title">友情链接</span> <span class="arrow down"></span></button> <button type="button" aria-label="友情链接菜单" class="mobile-dropdown-title"><span class="title">友情链接</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://jkchao.github.io/typescript-book-chinese/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  深入理解 TypeScript
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://ts.xcatliu.com/introduction/hello-typescript" target="_blank" rel="noopener noreferrer" class="nav-link external">
  hello-typescript
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="http://www.typescriptlang.org/docs/home.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  TypeScript手册（英文版）
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/Microsoft/TypeScript/blob/master/doc/spec.md" target="_blank" rel="noopener noreferrer" class="nav-link external">
  TypeScript语言规范
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/zhongsp/TypeScript/blob/master/CONTRIBUTING.md" target="_blank" rel="noopener noreferrer" class="nav-link external">
  参与贡献
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="https://github.com/bosens-China/Typescript-manual" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/bosens-China/Typescript-manual/issues" target="_blank" rel="noopener noreferrer" class="nav-link external">
  问题反馈
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/Typescript-manual/describe/" class="nav-link">
  进入目录
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="友情链接菜单" class="dropdown-title"><span class="title">友情链接</span> <span class="arrow down"></span></button> <button type="button" aria-label="友情链接菜单" class="mobile-dropdown-title"><span class="title">友情链接</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://jkchao.github.io/typescript-book-chinese/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  深入理解 TypeScript
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://ts.xcatliu.com/introduction/hello-typescript" target="_blank" rel="noopener noreferrer" class="nav-link external">
  hello-typescript
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="http://www.typescriptlang.org/docs/home.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  TypeScript手册（英文版）
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/Microsoft/TypeScript/blob/master/doc/spec.md" target="_blank" rel="noopener noreferrer" class="nav-link external">
  TypeScript语言规范
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/zhongsp/TypeScript/blob/master/CONTRIBUTING.md" target="_blank" rel="noopener noreferrer" class="nav-link external">
  参与贡献
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="https://github.com/bosens-China/Typescript-manual" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/bosens-China/Typescript-manual/issues" target="_blank" rel="noopener noreferrer" class="nav-link external">
  问题反馈
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/Typescript-manual/describe/" class="sidebar-link">前言</a></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>快速上手</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Typescript-manual/download/zh/tutorials/typescript-in-5-minutes.html" class="sidebar-link">5 分钟了解 TypeScript</a></li><li><a href="/Typescript-manual/download/zh/tutorials/asp.net-core.html" class="sidebar-link">ASP.NET Core</a></li><li><a href="/Typescript-manual/download/zh/tutorials/asp.net-4.html" class="sidebar-link">ASP.NET 4</a></li><li><a href="/Typescript-manual/download/zh/tutorials/gulp.html" class="sidebar-link">Gulp</a></li><li><a href="/Typescript-manual/download/zh/tutorials/knockout.html" class="sidebar-link">Knockout.js</a></li><li><a href="/Typescript-manual/download/zh/tutorials/react-and-webpack.html" class="sidebar-link">React 与 webpack</a></li><li><a href="/Typescript-manual/download/zh/tutorials/react.html" class="sidebar-link">React</a></li><li><a href="/Typescript-manual/download/zh/tutorials/angular-2.html" class="sidebar-link">Angular 2</a></li><li><a href="/Typescript-manual/download/zh/tutorials/migrating-from-javascript.html" class="sidebar-link">从 JavaScript 迁移到 TypeScript</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>手册</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Typescript-manual/download/zh/handbook/basic-types.html" class="sidebar-link">基础类型</a></li><li><a href="/Typescript-manual/download/zh/handbook/interfaces.html" class="sidebar-link">接口</a></li><li><a href="/Typescript-manual/download/zh/handbook/functions.html" class="sidebar-link">函数</a></li><li><a href="/Typescript-manual/download/zh/handbook/literal-types.html" class="sidebar-link">字面量类型</a></li><li><a href="/Typescript-manual/download/zh/handbook/unions-and-intersections.html" class="sidebar-link">联合类型和交叉类型</a></li><li><a href="/Typescript-manual/download/zh/handbook/classes.html" class="sidebar-link">类</a></li><li><a href="/Typescript-manual/download/zh/handbook/enums.html" class="sidebar-link">枚举</a></li><li><a href="/Typescript-manual/download/zh/handbook/generics.html" class="sidebar-link">泛型</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>手册（进阶）</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Typescript-manual/download/zh/reference/advanced-types.html" class="sidebar-link">高级类型</a></li><li><a href="/Typescript-manual/download/zh/reference/utility-types.html" class="sidebar-link">实用工具类型</a></li><li><a href="/Typescript-manual/download/zh/reference/decorators.html" class="sidebar-link">Decorators</a></li><li><a href="/Typescript-manual/download/zh/reference/declaration-merging.html" class="sidebar-link">声明合并</a></li><li><a href="/Typescript-manual/download/zh/reference/iterators-and-generators.html" class="sidebar-link">Iterators 和 Generators</a></li><li><a href="/Typescript-manual/download/zh/reference/jsx.html" class="sidebar-link">JSX</a></li><li><a href="/Typescript-manual/download/zh/reference/mixins.html" class="sidebar-link">混入</a></li><li><a href="/Typescript-manual/download/zh/reference/modules.html" class="sidebar-link">模块</a></li><li><a href="/Typescript-manual/download/zh/reference/module-resolution.html" class="sidebar-link">模块解析</a></li><li><a href="/Typescript-manual/download/zh/reference/namespaces.html" class="sidebar-link">命名空间</a></li><li><a href="/Typescript-manual/download/zh/reference/namespaces-and-modules.html" class="sidebar-link">命名空间和模块</a></li><li><a href="/Typescript-manual/download/zh/reference/symbols.html" class="sidebar-link">Symbols</a></li><li><a href="/Typescript-manual/download/zh/reference/triple-slash-directives.html" class="sidebar-link">三斜线指令</a></li><li><a href="/Typescript-manual/download/zh/reference/type-compatibility.html" class="sidebar-link">类型兼容性</a></li><li><a href="/Typescript-manual/download/zh/reference/type-inference.html" class="sidebar-link">类型推论</a></li><li><a href="/Typescript-manual/download/zh/reference/variable-declarations.html" class="sidebar-link">变量声明</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>手册（v2）
</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Typescript-manual/download/zh/handbook-v2/type-manipulation/template-literal-types.html" class="sidebar-link">模版字面量类型</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>如何书写声明文件</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Typescript-manual/download/zh/declaration-files/introduction.html" class="sidebar-link">介绍</a></li><li><a href="/Typescript-manual/download/zh/declaration-files/by-example.html" class="sidebar-link">举例</a></li><li><a href="/Typescript-manual/download/zh/declaration-files/library-structures.html" class="sidebar-link">库结构</a></li><li><a href="/Typescript-manual/download/zh/declaration-files/templates.html" class="sidebar-link">模板</a></li><li><a href="/Typescript-manual/download/zh/declaration-files/do-s-and-don-ts.html" class="sidebar-link">最佳实践</a></li><li><a href="/Typescript-manual/download/zh/declaration-files/deep-dive.html" class="sidebar-link">深入</a></li><li><a href="/Typescript-manual/download/zh/declaration-files/publishing.html" class="sidebar-link">发布</a></li><li><a href="/Typescript-manual/download/zh/declaration-files/consumption.html" class="sidebar-link">使用</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>JavaScript
</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Typescript-manual/download/zh/javascript/type-checking-javascript-files.html" class="sidebar-link">JavaScript 文件里的类型检查</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>工程配置</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Typescript-manual/download/zh/project-config/tsconfig.json.html" class="sidebar-link">tsconfig.json</a></li><li><a href="/Typescript-manual/download/zh/project-config/project-references.html" class="sidebar-link">工程引用</a></li><li><a href="/Typescript-manual/download/zh/project-config/typings-for-npm-packages.html" class="sidebar-link">NPM 包的类型</a></li><li><a href="/Typescript-manual/download/zh/project-config/compiler-options.html" class="sidebar-link">编译选项</a></li><li><a href="/Typescript-manual/download/zh/project-config/configuring-watch.html" class="sidebar-link">配置 Watch</a></li><li><a href="/Typescript-manual/download/zh/project-config/compiler-options-in-msbuild.html" class="sidebar-link">在 MSBuild 里使用编译选项</a></li><li><a href="/Typescript-manual/download/zh/project-config/integrating-with-build-tools.html" class="sidebar-link">与其它构建工具整合</a></li><li><a href="/Typescript-manual/download/zh/project-config/nightly-builds.html" class="sidebar-link">使用 TypeScript 的每日构建版本</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Wiki</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Typescript-manual/download/zh/wiki/this-in-typescript.html" class="sidebar-link">TypeScript 里的 this</a></li><li><a href="/Typescript-manual/download/zh/wiki/coding_guidelines.html" class="sidebar-link">编码规范</a></li><li><a href="/Typescript-manual/download/zh/wiki/common-errors.html" class="sidebar-link">常见编译错误</a></li><li><a href="/Typescript-manual/download/zh/wiki/typescript-editor-support.html" class="sidebar-link">支持 TypeScript 的编辑器</a></li><li><a href="/Typescript-manual/download/zh/wiki/using-typescript-with-asp.net-5.html" class="sidebar-link">结合 ASP.NET v5 使用 TypeScript</a></li><li><a href="/Typescript-manual/download/zh/wiki/architectural-overview.html" class="sidebar-link">架构概述</a></li><li><a href="/Typescript-manual/download/zh/wiki/roadmap.html" class="sidebar-link">发展路线图</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>新增功能</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Typescript-manual/download/zh/release-notes/typescript-5.7.html" class="sidebar-link">TypeScript 5.7</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-5.6.html" class="sidebar-link">TypeScript 5.6</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-5.5.html" class="sidebar-link">TypeScript 5.5</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-5.4.html" class="sidebar-link">TypeScript 5.4</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-5.3.html" class="sidebar-link">TypeScript 5.3</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-5.2.html" class="sidebar-link">TypeScript 5.2</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-5.1.html" class="sidebar-link">TypeScript 5.1</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-5.0.html" class="sidebar-link">TypeScript 5.0</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-4.9.html" class="sidebar-link">TypeScript 4.9</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-4.8.html" class="sidebar-link">TypeScript 4.8</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-4.7.html" class="sidebar-link">TypeScript 4.7</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-4.6.html" class="sidebar-link">TypeScript 4.6</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-4.5.html" class="sidebar-link">TypeScript 4.5</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-4.4.html" class="sidebar-link">TypeScript 4.4</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-4.3.html" class="sidebar-link">TypeScript 4.3</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-4.2.html" class="sidebar-link">TypeScript 4.2</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-4.1.html" class="sidebar-link">TypeScript 4.1</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-4.0.html" class="sidebar-link">TypeScript 4.0</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-3.9.html" class="sidebar-link">TypeScript 3.9</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-3.8.html" class="sidebar-link">TypeScript 3.8</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-3.7.html" aria-current="page" class="active sidebar-link">TypeScript 3.7</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Typescript-manual/download/zh/release-notes/typescript-3.7.html#可选链-optional-chaining" class="sidebar-link">可选链（Optional Chaining）</a></li><li class="sidebar-sub-header"><a href="/Typescript-manual/download/zh/release-notes/typescript-3.7.html#空值合并-nullish-coalescing" class="sidebar-link">空值合并（Nullish Coalescing）</a></li><li class="sidebar-sub-header"><a href="/Typescript-manual/download/zh/release-notes/typescript-3.7.html#断言函数" class="sidebar-link">断言函数</a></li><li class="sidebar-sub-header"><a href="/Typescript-manual/download/zh/release-notes/typescript-3.7.html#更好地支持返回-never-的函数" class="sidebar-link">更好地支持返回 never 的函数</a></li><li class="sidebar-sub-header"><a href="/Typescript-manual/download/zh/release-notes/typescript-3.7.html#更加-递归的类型别名" class="sidebar-link">（更加）递归的类型别名</a></li><li class="sidebar-sub-header"><a href="/Typescript-manual/download/zh/release-notes/typescript-3.7.html#declaration-和-allowjs" class="sidebar-link">--declaration 和 --allowJs</a></li><li class="sidebar-sub-header"><a href="/Typescript-manual/download/zh/release-notes/typescript-3.7.html#usedefineforclassfields-编译选项和-declare-属性修饰符" class="sidebar-link">useDefineForClassFields 编译选项和 declare 属性修饰符</a></li><li class="sidebar-sub-header"><a href="/Typescript-manual/download/zh/release-notes/typescript-3.7.html#利用项目引用实现无构建编辑" class="sidebar-link">利用项目引用实现无构建编辑</a></li><li class="sidebar-sub-header"><a href="/Typescript-manual/download/zh/release-notes/typescript-3.7.html#检查未调用的函数" class="sidebar-link">检查未调用的函数</a></li><li class="sidebar-sub-header"><a href="/Typescript-manual/download/zh/release-notes/typescript-3.7.html#typescript-文件中的-ts-nocheck" class="sidebar-link">TypeScript 文件中的 // @ts-nocheck</a></li><li class="sidebar-sub-header"><a href="/Typescript-manual/download/zh/release-notes/typescript-3.7.html#分号格式化选项" class="sidebar-link">分号格式化选项</a></li><li class="sidebar-sub-header"><a href="/Typescript-manual/download/zh/release-notes/typescript-3.7.html#_3-7-的破坏性变更" class="sidebar-link">3.7 的破坏性变更</a></li></ul></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-3.6.html" class="sidebar-link">TypeScript 3.6</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-3.5.html" class="sidebar-link">TypeScript 3.5</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-3.4.html" class="sidebar-link">TypeScript 3.4</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-3.3.html" class="sidebar-link">TypeScript 3.3</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-3.2.html" class="sidebar-link">TypeScript 3.2</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-3.1.html" class="sidebar-link">TypeScript 3.1</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-3.0.html" class="sidebar-link">TypeScript 3.0</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-2.9.html" class="sidebar-link">TypeScript 2.9</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-2.8.html" class="sidebar-link">TypeScript 2.8</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-2.7.html" class="sidebar-link">TypeScript 2.7</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-2.6.html" class="sidebar-link">TypeScript 2.6</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-2.5.html" class="sidebar-link">TypeScript 2.5</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-2.4.html" class="sidebar-link">TypeScript 2.4</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-2.3.html" class="sidebar-link">TypeScript 2.3</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-2.2.html" class="sidebar-link">TypeScript 2.2</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-2.1.html" class="sidebar-link">TypeScript 2.1</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-2.0.html" class="sidebar-link">TypeScript 2.0</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-1.8.html" class="sidebar-link">TypeScript 1.8</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-1.7.html" class="sidebar-link">TypeScript 1.7</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-1.6.html" class="sidebar-link">TypeScript 1.6</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-1.5.html" class="sidebar-link">TypeScript 1.5</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-1.4.html" class="sidebar-link">TypeScript 1.4</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-1.3.html" class="sidebar-link">TypeScript 1.3</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-1.1.html" class="sidebar-link">TypeScript 1.1</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Breaking Changes</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Typescript-manual/download/zh/breaking-changes/typescript-3.6.html" class="sidebar-link">TypeScript 3.6</a></li><li><a href="/Typescript-manual/download/zh/breaking-changes/typescript-3.5.html" class="sidebar-link">TypeScript 3.5</a></li><li><a href="/Typescript-manual/download/zh/breaking-changes/typescript-3.4.html" class="sidebar-link">TypeScript 3.4</a></li><li><a href="/Typescript-manual/download/zh/breaking-changes/typescript-3.2.html" class="sidebar-link">TypeScript 3.2</a></li><li><a href="/Typescript-manual/download/zh/breaking-changes/typescript-3.1.html" class="sidebar-link">TypeScript 3.1</a></li><li><a href="/Typescript-manual/download/zh/breaking-changes/typescript-3.0.html" class="sidebar-link">TypeScript 3.0</a></li><li><a href="/Typescript-manual/download/zh/breaking-changes/typescript-2.9.html" class="sidebar-link">TypeScript 2.9</a></li><li><a href="/Typescript-manual/download/zh/breaking-changes/typescript-2.8.html" class="sidebar-link">TypeScript 2.8</a></li><li><a href="/Typescript-manual/download/zh/breaking-changes/typescript-2.7.html" class="sidebar-link">TypeScript 2.7</a></li><li><a href="/Typescript-manual/download/zh/breaking-changes/typescript-2.6.html" class="sidebar-link">TypeScript 2.6</a></li><li><a href="/Typescript-manual/download/zh/breaking-changes/typescript-2.4.html" class="sidebar-link">TypeScript 2.4</a></li><li><a href="/Typescript-manual/download/zh/breaking-changes/typescript-2.3.html" class="sidebar-link">TypeScript 2.3</a></li><li><a href="/Typescript-manual/download/zh/breaking-changes/typescript-2.2.html" class="sidebar-link">TypeScript 2.2</a></li><li><a href="/Typescript-manual/download/zh/breaking-changes/typescript-2.1.html" class="sidebar-link">TypeScript 2.1</a></li><li><a href="/Typescript-manual/download/zh/breaking-changes/typescript-2.0.html" class="sidebar-link">TypeScript 2.0</a></li><li><a href="/Typescript-manual/download/zh/breaking-changes/typescript-1.8.html" class="sidebar-link">TypeScript 1.8</a></li><li><a href="/Typescript-manual/download/zh/breaking-changes/typescript-1.7.html" class="sidebar-link">TypeScript 1.7</a></li><li><a href="/Typescript-manual/download/zh/breaking-changes/typescript-1.6.html" class="sidebar-link">TypeScript 1.6</a></li><li><a href="/Typescript-manual/download/zh/breaking-changes/typescript-1.5.html" class="sidebar-link">TypeScript 1.5</a></li><li><a href="/Typescript-manual/download/zh/breaking-changes/typescript-1.4.html" class="sidebar-link">TypeScript 1.4</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="typescript-3-7"><a href="#typescript-3-7" class="header-anchor">#</a> TypeScript 3.7</h1> <h2 id="可选链-optional-chaining"><a href="#可选链-optional-chaining" class="header-anchor">#</a> 可选链（Optional Chaining）</h2> <p><a href="http://www.typescriptlang.org/play/#example/optional-chaining" target="_blank" rel="noopener noreferrer">Playground<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>在我们的 issue 列表上，可选链是 <a href="https://github.com/microsoft/TypeScript/issues/16" target="_blank" rel="noopener noreferrer">issue #16<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。感受一下，从那之后 TypeScript 的 issue 列表中新增了 23,000 条 issues。</p> <p>可选链的核心是，在我们编写代码中，当遇到  <code>null</code>  或  <code>undefined</code> ，TypeScript 可以立即停止解析一部分表达式。
可选链的关键点是一个为 <em>可选属性访问</em> 提供的新的运算符  <code>?.</code> 。
比如我们可以这样写代码：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">let</span> x <span class="token operator">=</span> foo<span class="token operator">?.</span>bar<span class="token punctuation">.</span><span class="token function">baz</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>意思是，当  <code>foo</code>  有定义时，执行  <code>foo.bar.baz()</code>  的计算；但是当  <code>foo</code>  是  <code>null</code>  或  <code>undefined</code>  时，停止后续的解析，直接返回  <code>undefined</code> 。</p> <p>更明确地说，上面的代码和下面的代码等价。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">let</span> x <span class="token operator">=</span> foo <span class="token operator">===</span> <span class="token keyword">null</span> <span class="token operator">||</span> foo <span class="token operator">===</span> <span class="token keyword">undefined</span> <span class="token operator">?</span> <span class="token keyword">undefined</span> <span class="token operator">:</span> foo<span class="token punctuation">.</span>bar<span class="token punctuation">.</span><span class="token function">baz</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>注意，当  <code>bar</code>  是  <code>null</code>  或  <code>undefined</code> ，我们的代码访问  <code>baz</code>  依然会报错。
同理，当  <code>baz</code>  是  <code>null</code>  或  <code>undefined</code> ，在调用时也会报错。
 <code>?.</code>  只检查它 <em>左边</em> 的值是不是  <code>null</code>  或  <code>undefined</code> ，不检查后续的属性。</p> <p>你会发现自己可以使用  <code>?.</code>  来替换用了  <code>&amp;&amp;</code>  的大量空值检查代码。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// 以前</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>foo <span class="token operator">&amp;&amp;</span> foo<span class="token punctuation">.</span>bar <span class="token operator">&amp;&amp;</span> foo<span class="token punctuation">.</span>bar<span class="token punctuation">.</span>baz<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>

<span class="token comment">// 以后</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>foo<span class="token operator">?.</span>bar<span class="token operator">?.</span>baz<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre></div><p>注意， <code>?.</code>  与  <code>&amp;&amp;</code>  的行为略有不同，因为  <code>&amp;&amp;</code>  会作用在所有 “假” 值上（例如，空字符串、 <code>0</code> 、 <code>NaN</code>  以及  <code>false</code> ），但  <code>?.</code>  是一个仅作用于结构上的特性。
它不会在有效数据（比如  <code>0</code>  或空字符串）上进行短路计算。</p> <p>可选链还包括两个另外的用法。
首先是 <em>可选元素访问</em>，表现类似于可选属性访问，但是也允许我们访问非标识符属性（例如：任意字符串、数字和 symbol）：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">/**
 * 如果 arr 是一个数组，返回第一个元素
 * 否则返回 undefined
 */</span>
<span class="token keyword">function</span> <span class="token generic-function"><span class="token function">tryGetFirstElement</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>arr<span class="token operator">?</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> arr<span class="token operator">?.</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token comment">// 等价于：</span>
  <span class="token comment">//   return (arr === null || arr === undefined) ?</span>
  <span class="token comment">//       undefined :</span>
  <span class="token comment">//       arr[0];</span>
<span class="token punctuation">}</span>
</code></pre></div><p>另一个是 <em>可选调用</em>，判断条件是当该表达式不是  <code>null</code>  或  <code>undefined</code> ，我们就可以调用它。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">makeRequest</span><span class="token punctuation">(</span>url<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> log<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">(</span>msg<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  log<span class="token operator">?.</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Request started at </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toISOString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 基本等价于：</span>
  <span class="token comment">//   if (log != null) {</span>
  <span class="token comment">//       log(`Request started at ${new Date().toISOString()}`);</span>
  <span class="token comment">//   }</span>

  <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  log<span class="token operator">?.</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Request finished at at </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toISOString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>可选链的 “短路计算” 行为仅限于属性访问、调用、元素访问 —— 它不会延伸到后续的表达式中。
也就是说，</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">let</span> result <span class="token operator">=</span> foo<span class="token operator">?.</span>bar <span class="token operator">/</span> <span class="token function">someComputation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>可选链不会阻止除法运算或  <code>someComputation()</code>  的进行。
上面这段代码实际上等价于：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">let</span> temp <span class="token operator">=</span> foo <span class="token operator">===</span> <span class="token keyword">null</span> <span class="token operator">||</span> foo <span class="token operator">===</span> <span class="token keyword">undefined</span> <span class="token operator">?</span> <span class="token keyword">undefined</span> <span class="token operator">:</span> foo<span class="token punctuation">.</span>bar<span class="token punctuation">;</span>

<span class="token keyword">let</span> result <span class="token operator">=</span> temp <span class="token operator">/</span> <span class="token function">someComputation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>当然，这可能会使得  <code>undefined</code>  参与了除法运算，导致在  <code>strictNullChecks</code>  编译选项下产生报错。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">barPercentage</span><span class="token punctuation">(</span>foo<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">{</span> bar<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> foo<span class="token operator">?.</span>bar <span class="token operator">/</span> <span class="token number">100</span><span class="token punctuation">;</span>
  <span class="token comment">//     ~~~~~~~~</span>
  <span class="token comment">// Error: Object is possibly undefined.</span>
<span class="token punctuation">}</span>
</code></pre></div><p>想了解更多细节，你可以 <a href="https://github.com/tc39/proposal-optional-chaining/" target="_blank" rel="noopener noreferrer">检阅完整的草案<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 以及 <a href="https://github.com/microsoft/TypeScript/pull/33294" target="_blank" rel="noopener noreferrer">查看原始的 PR<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <h2 id="空值合并-nullish-coalescing"><a href="#空值合并-nullish-coalescing" class="header-anchor">#</a> 空值合并（Nullish Coalescing）</h2> <p><a href="http://www.typescriptlang.org/play/#example/nullish-coalescing" target="_blank" rel="noopener noreferrer">Playground<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><em>空值合并运算符</em> 是另一个即将到来的 ECMAScript 特性（与可选链一起），我们的团队也参与了 TC39 的的讨论工作。</p> <p>你可以考虑使用  <code>??</code>  运算符来实现：当字段是  <code>null</code>  或  <code>undefined</code>  时，“回退” 到默认值。
比如我们可以这样写代码：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">let</span> x <span class="token operator">=</span> foo <span class="token operator">??</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>这种新方式的意思是，当  <code>foo</code>  “存在” 时 x 等于 foo；
但假如  <code>foo</code>  是  <code>null</code>  或  <code>undefined</code>  ，x 等于  <code>bar()</code>  的计算结果。</p> <p>同样的，上面的代码可以写出等价代码。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">let</span> x <span class="token operator">=</span> foo <span class="token operator">!==</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> foo <span class="token operator">!==</span> <span class="token keyword">undefined</span> <span class="token operator">?</span> foo <span class="token operator">:</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>当尝试使用默认值时， <code>??</code>  运算符可以代替  <code>||</code>  的作用。
例如，下面的代码片段尝试获取上一次储存在 <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Window/localStorage" target="_blank" rel="noopener noreferrer"><code>localStorage</code> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 中的 volume（如果它已保存）;
 但是因为使用了  <code>||</code>  ，留下一个 bug。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">initializeAudio</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> volume <span class="token operator">=</span> localStorage<span class="token punctuation">.</span>volume <span class="token operator">||</span> <span class="token number">0.5</span><span class="token punctuation">;</span>

  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre></div><p>如果  <code>localStorage.volume</code>  的值是  <code>0</code> ，这段代码将会把 volume 的值设置为  <code>0.5</code> ，这是一个意外情况。
而  <code>??</code>  避免了将  <code>0</code> 、 <code>NaN</code>  和  <code>&quot;&quot;</code>  视为假值的意外情况。</p> <p>我们非常感谢社区成员 <a href="https://github.com/Kingwl" target="_blank" rel="noopener noreferrer">Wenlu Wang<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 和 <a href="https://github.com/dragomirtitian" target="_blank" rel="noopener noreferrer">Titian Cernicova Dragomir<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 实现了这个特性！
想了解更多细节，你可以 <a href="https://github.com/microsoft/TypeScript/pull/32883" target="_blank" rel="noopener noreferrer">查看他们的 PR<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 和 <a href="https://github.com/tc39/proposal-nullish-coalescing/" target="_blank" rel="noopener noreferrer">空值合并草案的 Repo<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <h2 id="断言函数"><a href="#断言函数" class="header-anchor">#</a> 断言函数</h2> <p><a href="http://www.typescriptlang.org/play/#example/assertion-functions" target="_blank" rel="noopener noreferrer">Playground<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>有一类特定的函数，用于在出现非预期结果时抛出一个错误。
这样的函数叫做 “断言” 函数（Assertion Function）。
比方说，Node.js 中就有一个名为  <code>assert</code>  的断言函数。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">assert</span><span class="token punctuation">(</span>someValue <span class="token operator">===</span> <span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>在上面的例子中，如果  <code>someValue</code>  不等于 42，那么  <code>assert</code>  就会抛出一个  <code>AssertionError</code>  错误。</p> <p>在 JavaScript 中，断言经常被用于防止不正确传参。
举个例子：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">multiply</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">assert</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> x <span class="token operator">===</span> <span class="token string">'number'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">assert</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> y <span class="token operator">===</span> <span class="token string">'number'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> x <span class="token operator">*</span> y<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>很遗憾，在 TypeScript 中，这些检查没办法正确编码。
对于类型宽松的代码，意味着 TypeScript 检查得更少，而对于更加规范的代码，通常迫使使用者添加类型断言。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">yell</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">assert</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> str <span class="token operator">===</span> <span class="token string">'string'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> str<span class="token punctuation">.</span><span class="token function">toUppercase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 糟了！我们拼错了 'toUpperCase'。</span>
  <span class="token comment">// 如果 TypeScript 依然能检查出来就太棒了！</span>
<span class="token punctuation">}</span>
</code></pre></div><p>有一个替代的写法，可以让 TypeScript 能够分析出问题，不过这样并不方便。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">yell</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> str <span class="token operator">!==</span> <span class="token string">'string'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">TypeError</span><span class="token punctuation">(</span><span class="token string">'str should have been a string.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 发现错误！</span>
  <span class="token keyword">return</span> str<span class="token punctuation">.</span><span class="token function">toUppercase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>归根结底，TypeScript 的目标是以最小的改动为现存的 JavaScript 结构添加上类型声明。
因此，TypeScript 3.7 引入了一个称为 “断言签名” 的新概念，用于模拟这些断言函数。</p> <p>第一种断言签名模拟了 Node 中  <code>assert</code>  函数的功能。
它确保在断言的范围内，无论什么判断条件都为必须真。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">assert</span><span class="token punctuation">(</span>condition<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> msg<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">asserts</span> condition <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>condition<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">AssertionError</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>asserts condition</code>  表示：如果  <code>assert</code>  函数成功返回，则传入的  <code>condition</code>  参数必须为真（否则它应该抛出一个 Error）。
这意味着对于同作用域中的后续代码，条件必须为真。
回到例子上，用这个断言函数意味着我们 <em>能够</em> 捕获之前  <code>yell</code>  示例中的错误。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">yell</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">assert</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> str <span class="token operator">===</span> <span class="token string">'string'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> str<span class="token punctuation">.</span><span class="token function">toUppercase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//         ~~~~~~~~~~~</span>
  <span class="token comment">// error: Property 'toUppercase' does not exist on type 'string'.</span>
  <span class="token comment">//        Did you mean 'toUpperCase'?</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">assert</span><span class="token punctuation">(</span>condition<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> msg<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">asserts</span> condition <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>condition<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">AssertionError</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>另一种类型的断言签名不通过检查条件语句实现，而是在 TypeScript 里显式指定某个变量或属性具有不同的类型。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">assertIsString</span><span class="token punctuation">(</span>val<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">asserts</span> val <span class="token keyword">is</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> val <span class="token operator">!==</span> <span class="token string">'string'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">AssertionError</span><span class="token punctuation">(</span><span class="token string">'Not a string!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这里的  <code>asserts val is string</code>  保证了在  <code>assertIsString</code>  调用之后，传入的任何变量都有可以被视为是  <code>string</code>  类型的。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">yell</span><span class="token punctuation">(</span>str<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">assertIsString</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 现在 TypeScript 知道 'str' 是一个 'string'。</span>

  <span class="token keyword">return</span> str<span class="token punctuation">.</span><span class="token function">toUppercase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//         ~~~~~~~~~~~</span>
  <span class="token comment">// error: Property 'toUppercase' does not exist on type 'string'.</span>
  <span class="token comment">//        Did you mean 'toUpperCase'?</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这些断言方法签名类似于类型谓词（type predicate）签名：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">isString</span><span class="token punctuation">(</span>val<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span><span class="token operator">:</span> val <span class="token keyword">is</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">typeof</span> val <span class="token operator">===</span> <span class="token string">'string'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">yell</span><span class="token punctuation">(</span>str<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isString</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> str<span class="token punctuation">.</span><span class="token function">toUppercase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">throw</span> <span class="token string">'Oops!'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>就像类型谓词签名一样，这些断言签名具有清晰的表现力。
我们可以用它们表达一些非常复杂的想法。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token generic-function"><span class="token function">assertIsDefined</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>val<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">asserts</span> val <span class="token keyword">is</span> NonNullable<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>val <span class="token operator">===</span> <span class="token keyword">undefined</span> <span class="token operator">||</span> val <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">AssertionError</span><span class="token punctuation">(</span>
      <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Expected 'val' to be defined, but received </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>val<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>想了解更多断言签名的细节，可以 <a href="https://github.com/microsoft/TypeScript/pull/32695" target="_blank" rel="noopener noreferrer">查看原始的 PR<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <h2 id="更好地支持返回-never-的函数"><a href="#更好地支持返回-never-的函数" class="header-anchor">#</a> 更好地支持返回  <code>never</code>  的函数</h2> <p>作为断言签名实现的一部分，TypeScript 需要编码更多关于调用位置和调用函数的细节。
这给了我们机会扩展对另一类函数的支持 —— 返回  <code>never</code>  的函数。</p> <p>返回  <code>never</code>  的函数，即永远不会返回的函数。
它表明抛出了异常、触发了停止错误条件、或程序退出的情况。
例如，<a href="https://github.com/DefinitelyTyped/DefinitelyTyped/blob/5299d372a220584e75a031c13b3d555607af13f8/types/node/globals.d.ts#l874" target="_blank" rel="noopener noreferrer"><code>@types/node</code>  中的  <code>process.exit(...)</code> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 就被指定为返回  <code>never</code> 。</p> <p>为了确保函数永远不会潜在地返回  <code>undefined</code> 、或者从所有代码路径中有效地返回，TypeScript 需要借助一些语法标志 —— 函数结尾处的  <code>return</code>  或  <code>throw</code> 。
这样，使用者就会发现自己的代码在 “返回” 一个停机函数。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">dispatch</span><span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">number</span><span class="token punctuation">)</span><span class="token operator">:</span> SomeType <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> x <span class="token operator">===</span> <span class="token string">'string'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">doThingWithString</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> x <span class="token operator">===</span> <span class="token string">'number'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">doThingWithNumber</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> process<span class="token punctuation">.</span><span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>现在，这些返回  <code>never</code>  的函数被调用时，TypeScript 能识别出它们将影响代码执行流程，同时说明原因。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">dispatch</span><span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">number</span><span class="token punctuation">)</span><span class="token operator">:</span> SomeType <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> x <span class="token operator">===</span> <span class="token string">'string'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">doThingWithString</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> x <span class="token operator">===</span> <span class="token string">'number'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">doThingWithNumber</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  process<span class="token punctuation">.</span><span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>你可以和在断言函数的 <a href="https://github.com/microsoft/TypeScript/pull/32695" target="_blank" rel="noopener noreferrer">同一个 PR 中查看更多细节<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <h2 id="更加-递归的类型别名"><a href="#更加-递归的类型别名" class="header-anchor">#</a> （更加）递归的类型别名</h2> <p><a href="http://www.typescriptlang.org/play/#example/recursive-type-references" target="_blank" rel="noopener noreferrer">Playground<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>类型别名在 “递归” 引用方面一直存在局限性。
原因是，类型别名必须能用它代表的东西来代替自己。
这在某些情况下是不可能的，因此编译器会拒绝某些递归别名，比如下面这个：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">type</span> <span class="token class-name">Foo</span> <span class="token operator">=</span> Foo<span class="token punctuation">;</span>
</code></pre></div><p>这是一个合理的限制，因为任何对  <code>Foo</code>  的使用都可以替换为  <code>Foo</code> ，同时这个  <code>Foo</code>  能够替换为  <code>Foo</code> ，而这个  <code>Foo</code>  应该……（产生了无限循环）希望你理解到这个意思了！
到最后，没有类型可以用来代替  <code>Foo</code> 。</p> <p><a href="https://en.wikipedia.org/w/index.php?title=Recursive_data_type&amp;oldid=913091335#in_type_synonyms" target="_blank" rel="noopener noreferrer">其他语言也是这么处理类型别名的<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，但是它确实会产生一些令人困惑的情形，影响类型别名的使用。
例如，在 TypeScript 3.6 和更低的版本中，下面的代码会报错：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">type</span> <span class="token class-name">ValueOrArray<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token operator">=</span> <span class="token constant">T</span> <span class="token operator">|</span> <span class="token builtin">Array</span><span class="token operator">&lt;</span>ValueOrArray<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">;</span>
<span class="token comment">//   ~~~~~~~~~~~~</span>
<span class="token comment">// error: Type alias 'ValueOrArray' circularly references itself.</span>
</code></pre></div><p>这很令人困惑，因为使用者总是可以用接口来编写具有相同作用的代码，那么从技术上讲这没什么问题。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">type</span> <span class="token class-name">ValueOrArray<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token operator">=</span> <span class="token constant">T</span> <span class="token operator">|</span> ArrayOfValueOrArray<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>

<span class="token keyword">interface</span> <span class="token class-name">ArrayOfValueOrArray<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token builtin">Array</span><span class="token operator">&lt;</span>ValueOrArray<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;&gt;</span></span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><p>因为接口（以及其他对象 type）引入了一个间接的层级，并且它们的完整结构不需要立即建立，所以 TypeScript 可以处理这种结构。</p> <p>但是，对于使用者而言，引入接口的方案并不直观。
并且，用了  <code>Array</code>  的初始版  <code>ValueOrArray</code>  没什么原则性问题。
如果编译器多一点 “惰性”，并且只按需计算  <code>Array</code>  的类型参数，那么 TypeScript 就可以正确地表示出这些了。</p> <p>这正是 TypeScript 3.7 引入的。
在类型别名的 “顶层”，TypeScript 将推迟解析类型参数以便支持这些模式。</p> <p>这意味着，用于表示 JSON 的以下代码……</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">type</span> <span class="token class-name">Json</span> <span class="token operator">=</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">number</span> <span class="token operator">|</span> <span class="token builtin">boolean</span> <span class="token operator">|</span> <span class="token keyword">null</span> <span class="token operator">|</span> JsonObject <span class="token operator">|</span> JsonArray<span class="token punctuation">;</span>

<span class="token keyword">interface</span> <span class="token class-name">JsonObject</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span>property<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">:</span> Json<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">interface</span> <span class="token class-name">JsonArray</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token builtin">Array</span><span class="token operator">&lt;</span>Json<span class="token operator">&gt;</span></span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><p>终于可以重写成不需要借助 interface 的形式。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">type</span> <span class="token class-name">Json</span> <span class="token operator">=</span>
  <span class="token operator">|</span> <span class="token builtin">string</span>
  <span class="token operator">|</span> <span class="token builtin">number</span>
  <span class="token operator">|</span> <span class="token builtin">boolean</span>
  <span class="token operator">|</span> <span class="token keyword">null</span>
  <span class="token operator">|</span> <span class="token punctuation">{</span> <span class="token punctuation">[</span>property<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">:</span> Json <span class="token punctuation">}</span>
  <span class="token operator">|</span> Json<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p>这个新的机制让我们在元组中，同样也可以递归地使用类型别名。
下面的 TypeScript 代码在以前会报错，但现在是合法的：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">type</span> <span class="token class-name">VirtualNode</span> <span class="token operator">=</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token punctuation">[</span>key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">any</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token operator">...</span>VirtualNode<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> myNode<span class="token operator">:</span> VirtualNode <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token string">'div'</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token string">'parent'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token string">'div'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token string">'first-child'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">&quot;I'm the first child&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token string">'div'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token string">'second-child'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">&quot;I'm the second child&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p>想了解更多细节，你可以 <a href="https://github.com/microsoft/TypeScript/pull/33050" target="_blank" rel="noopener noreferrer">查看原始的 PR<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <h2 id="declaration-和-allowjs"><a href="#declaration-和-allowjs" class="header-anchor">#</a> <code>--declaration</code>  和  <code>--allowJs</code></h2> <p><code>--declaration</code>  选项允许我们从 TypeScript 源文件（诸如  <code>.ts</code>  和  <code>.tsx</code>  文件）生成  <code>.d.ts</code>  文件（声明文件）。
 <code>.d.ts</code>  文件的重要性有几个方面：</p> <p>首先，它们使得 TypeScript 能够对外部项目进行类型检查，同时避免重复检查其源代码。
另一方面，它们使得 TypeScript 能够与现存的 JavaScript 库相互配合，即使这些库构建时并未使用 TypeScript。
最后，还有一个通常被忽略的好处：在使用支持 TypeScript 的编辑器时，TypeScript <em>和</em> JavaScript 使用者都可以从这些文件中受益，例如更高级的自动完成。</p> <p>不幸的是， <code>--declaration</code>  不能与  <code>--allowJs</code>  选项一起使用， <code>--allowJs</code>  选项允许混合使用 TypeScript 和 JavaScript 文件。
这是一个令人沮丧的限制，因为它意味着使用者在迁移代码库时无法使用  <code>--declaration</code>  选项，即使代码包含了 JSDoc 注释。
TypeScript 3.7 对此进行了改进，允许这两个选项一起使用！</p> <p>这个功能最大的影响可能比较微妙：在 TypeScript 3.7 中，编写带有 JSDoc 注释的 JavaScript 库，也能帮助 TypeScript 的使用者。</p> <p>它的实现原理是，在启用  <code>allowJs</code>  时，TypeScript 会尽可能地分析并理解常见的 JavaScript 模式；然而，用 JavaScript 表达的某些模式看起来不一定像它们在 TypeScript 中的等效形式。
启用  <code>declaration</code>  选项后，TypeScript 会尽力识别 JSDoc 注释和 CommonJS 形式的模块输出，并转换为有效的类型声明输出到  <code>.d.ts</code>  文件上。</p> <p>比如下面这个代码片段</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> assert <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'assert'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports<span class="token punctuation">.</span>blurImage <span class="token operator">=</span> blurImage<span class="token punctuation">;</span>

<span class="token comment">/**
 * Produces a blurred image from an input buffer.
 *
 * @param input {Uint8Array}
 * @param width {number}
 * @param height {number}
 */</span>
<span class="token keyword">function</span> <span class="token function">blurImage</span><span class="token punctuation">(</span><span class="token parameter">input<span class="token punctuation">,</span> width<span class="token punctuation">,</span> height</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> numPixels <span class="token operator">=</span> width <span class="token operator">*</span> height <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">;</span>
  <span class="token function">assert</span><span class="token punctuation">(</span>input<span class="token punctuation">.</span>length <span class="token operator">===</span> numPixels<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Uint8Array</span><span class="token punctuation">(</span>numPixels<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// TODO</span>

  <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>将会生成如下  <code>.d.ts</code>  文件</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">/**
 * Produces a blurred image from an input buffer.
 *
 * @param input {Uint8Array}
 * @param width {number}
 * @param height {number}
 */</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">blurImage</span><span class="token punctuation">(</span>
  input<span class="token operator">:</span> Uint8Array<span class="token punctuation">,</span>
  width<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span>
  height<span class="token operator">:</span> <span class="token builtin">number</span>
<span class="token punctuation">)</span><span class="token operator">:</span> Uint8Array<span class="token punctuation">;</span>
</code></pre></div><p>除了基本的带有  <code>@param</code>  标记的函数，也支持其他情形，请看下面这个例子：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/**
 * @callback Job
 * @returns {void}
 */</span>

<span class="token comment">/** Queues work */</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Worker</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">maxDepth <span class="token operator">=</span> <span class="token number">10</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>started <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>depthLimit <span class="token operator">=</span> maxDepth<span class="token punctuation">;</span>
    <span class="token comment">/**
     * NOTE: queued jobs may add more items to queue
     * @type {Job[]}
     */</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>queue <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">/**
   * Adds a work item to the queue
   * @param {Job} work
   */</span>
  <span class="token function">push</span><span class="token punctuation">(</span><span class="token parameter">work</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>queue<span class="token punctuation">.</span>length <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>depthLimit<span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Queue full!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>queue<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>work<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">/**
   * Starts the queue if it has not yet started
   */</span>
  <span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>started<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>started <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>queue<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">/** @type {Job} */</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>queue<span class="token punctuation">.</span><span class="token function">shift</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>会生成如下  <code>.d.ts</code>  文件：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">/**
 * @callback Job
 * @returns {void}
 */</span>
<span class="token comment">/** Queues work */</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Worker</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span>maxDepth<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  started<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
  depthLimit<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  <span class="token comment">/**
   * NOTE: queued jobs may add more items to queue
   * @type {Job[]}
   */</span>
  queue<span class="token operator">:</span> Job<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token comment">/**
   * Adds a work item to the queue
   * @param {Job} work
   */</span>
  <span class="token function">push</span><span class="token punctuation">(</span>work<span class="token operator">:</span> Job<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
  <span class="token comment">/**
   * Starts the queue if it has not yet started
   */</span>
  <span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">type</span> <span class="token class-name">Job</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
</code></pre></div><p>注意，当同时启用这两个选项时，TypeScript 不一定必须得编译成  <code>.js</code>  文件。
如果只是简单的想让 TypeScript 创建  <code>.d.ts</code>  文件，你可以启用  <code>--emitDeclarationOnly</code>  编译选项。</p> <p>想了解更多细节，你可以 <a href="https://github.com/microsoft/TypeScript/pull/32372" target="_blank" rel="noopener noreferrer">查看原始的 PR<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <h2 id="usedefineforclassfields-编译选项和-declare-属性修饰符"><a href="#usedefineforclassfields-编译选项和-declare-属性修饰符" class="header-anchor">#</a> <code>useDefineForClassFields</code>  编译选项和  <code>declare</code>  属性修饰符</h2> <p>当在 TypeScript 中写类公共字段时，我们尽力保证以下代码</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">class</span> <span class="token class-name"><span class="token constant">C</span></span> <span class="token punctuation">{</span>
  foo <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
  bar<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>等价于构造函数中的相似语句</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">class</span> <span class="token class-name"><span class="token constant">C</span></span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>foo <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>不幸的是，虽然这符合该提案早期的发展方向，但类公共字段极有可能以不同的方式进行标准化。
所以取而代之的，原始代码示例可能需要进行脱糖处理，变成类似下面的代码：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">class</span> <span class="token class-name"><span class="token constant">C</span></span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      enumerable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      configurable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      writable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      value<span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">'bar'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      enumerable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      configurable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      writable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      value<span class="token operator">:</span> <span class="token keyword">void</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>当然，TypeScript 3.7 在默认情况下的编译结果与之前版本没有变化，我们增量地发布改动，以便帮助使用者减少未来潜在的破坏性变更。
我们提供了一个新的编译选项  <code>useDefineForClassFields</code> ，根据一些新的检查逻辑使用上面这种编译模式。</p> <p>最大的两个改变如下：</p> <ul><li>声明通过  <code>Object.defineProperty</code>  完成。</li> <li>声明 <em>总是</em> 被初始化为  <code>undefined</code> ，即使原有代码中没有显式的初始值。</li></ul> <p>对于现存的含有继承的代码，这可能会造成一些问题。首先，基类的  <code>set</code>  访问器不再被触发 —— 它们将被完全覆写。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">class</span> <span class="token class-name">Base</span> <span class="token punctuation">{</span>
  <span class="token keyword">set</span> <span class="token function">data</span><span class="token punctuation">(</span>value<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'data changed to '</span> <span class="token operator">+</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Derived</span> <span class="token keyword">extends</span> <span class="token class-name">Base</span> <span class="token punctuation">{</span>
  <span class="token comment">// 当启用 'useDefineForClassFields' 时</span>
  <span class="token comment">// 不再触发 'console.log'</span>
  data <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>其次，基类中的属性设定也将不起作用。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">interface</span> <span class="token class-name">Animal</span> <span class="token punctuation">{</span>
  animalStuff<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">interface</span> <span class="token class-name">Dog</span> <span class="token keyword">extends</span> <span class="token class-name">Animal</span> <span class="token punctuation">{</span>
  dogStuff<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">AnimalHouse</span> <span class="token punctuation">{</span>
  resident<span class="token operator">:</span> Animal<span class="token punctuation">;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span>animal<span class="token operator">:</span> Animal<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>resident <span class="token operator">=</span> animal<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">DogHouse</span> <span class="token keyword">extends</span> <span class="token class-name">AnimalHouse</span> <span class="token punctuation">{</span>
  <span class="token comment">// 当启用 'useDefineForClassFields' 时</span>
  <span class="token comment">// 调用 'super()' 后</span>
  <span class="token comment">// 'resident' 只会被初始化成 'undefined'！</span>
  resident<span class="token operator">:</span> Dog<span class="token punctuation">;</span>

  <span class="token function">constructor</span><span class="token punctuation">(</span>dog<span class="token operator">:</span> Dog<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>dog<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这两个问题归结为，继承时混合覆写属性与访问器，以及属性不带初始值的重新声明。</p> <p>为了检测这个访问器的问题，TypeScript 3.7 现在可以在  <code>.d.ts</code>  文件中编译出  <code>get</code> / <code>set</code> ，这样 TypeScript 就能检查出访问器覆写的情况。</p> <p>对于改变类字段的代码，将字段初始化写成构造函数内的语句，就可以解决此问题。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">class</span> <span class="token class-name">Base</span> <span class="token punctuation">{</span>
  <span class="token keyword">set</span> <span class="token function">data</span><span class="token punctuation">(</span>value<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'data changed to '</span> <span class="token operator">+</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Derived</span> <span class="token keyword">extends</span> <span class="token class-name">Base</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    data <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>而解决第二个问题，你可以显式地提供一个初始值，或添加一个 <code>declare</code>  修饰符来表示这个属性不要被编译。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">interface</span> <span class="token class-name">Animal</span> <span class="token punctuation">{</span>
  animalStuff<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">interface</span> <span class="token class-name">Dog</span> <span class="token keyword">extends</span> <span class="token class-name">Animal</span> <span class="token punctuation">{</span>
  dogStuff<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">AnimalHouse</span> <span class="token punctuation">{</span>
  resident<span class="token operator">:</span> Animal<span class="token punctuation">;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span>animal<span class="token operator">:</span> Animal<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>resident <span class="token operator">=</span> animal<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">DogHouse</span> <span class="token keyword">extends</span> <span class="token class-name">AnimalHouse</span> <span class="token punctuation">{</span>
  <span class="token keyword">declare</span> resident<span class="token operator">:</span> Dog<span class="token punctuation">;</span>
  <span class="token comment">//  ^^^^^^^</span>
  <span class="token comment">// 'resident' now has a 'declare' modifier,</span>
  <span class="token comment">// and won't produce any output code.</span>

  <span class="token function">constructor</span><span class="token punctuation">(</span>dog<span class="token operator">:</span> Dog<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>dog<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>目前，只有当编译目标是 ES5 及以上时  <code>useDefineForClassFields</code>  才可用，因为 ES3 中不支持  <code>Object.defineProperty</code> 。
要检查类似的问题，你可以创建一个分离的项目，设定编译目标为 ES5 并使用  <code>--noEmit</code>  来避免完全构建。</p> <p>想了解更多细节，你可以 <a href="https://github.com/microsoft/TypeScript/pull/33509" target="_blank" rel="noopener noreferrer">去原始的 PR 查看这些改动<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <p>我们强烈建议使用者尝试  <code>useDefineForClassFields</code> ，并在 issues 或下面的评论区域中提供反馈。
应该碰到编译选项在使用难度上的反馈，这样我们就能够了解如何使迁移变得更容易。</p> <h2 id="利用项目引用实现无构建编辑"><a href="#利用项目引用实现无构建编辑" class="header-anchor">#</a> 利用项目引用实现无构建编辑</h2> <p>TypeScript 的项目引用功能，为我们提供了一种简单的方法来分解代码库，从而使编译速度更快。
遗憾的是，当我们编辑一个依赖未曾构建（或者构建结果过时）的项目时，体验不好。</p> <p>在 TypeScript 3.7 中，当打开一个带有依赖的项目时，TypeScript 将自动切换为使用依赖中的  <code>.ts</code> / <code>.tsx</code>  源码文件。
这意味着在带有外部引用的项目中，代码的修改会即时同步和生效，编码体验会得到提升。
你也可以适当地打开编译器选项  <code>disableSourceOfProjectReferenceRedirect</code>  来禁用这个引用的功能，因为在超大型项目中这个功能可能会影响性能。</p> <p>你可以 <a href="https://github.com/microsoft/TypeScript/pull/32028" target="_blank" rel="noopener noreferrer">阅读这个 PR 来了解这个改动的更多细节<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <h2 id="检查未调用的函数"><a href="#检查未调用的函数" class="header-anchor">#</a> 检查未调用的函数</h2> <p>一个常见且危险的错误是：忘记调用一个函数，特别是当该函数不需要参数，或者它的命名容易被误认为是一个属性而不是函数时。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">interface</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>
  <span class="token function">isAdministrator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
  <span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
  doNotDisturb<span class="token operator">?</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 之后…</span>

<span class="token comment">// 有问题的代码，别用！</span>
<span class="token keyword">function</span> <span class="token function">doAdminThing</span><span class="token punctuation">(</span>user<span class="token operator">:</span> User<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 糟了！</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>user<span class="token punctuation">.</span>isAdministrator<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">sudo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">editTheConfiguration</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">AccessDeniedError</span><span class="token punctuation">(</span><span class="token string">'User is not an admin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>在这段代码中，我们忘了调用  <code>isAdministrator</code> ，导致该代码错误地允许非管理员用户修改配置！</p> <p>在 TypeScript 3.7 中，它会被识别成一个潜在的错误：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">doAdminThing</span><span class="token punctuation">(</span>user<span class="token operator">:</span> User<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>user<span class="token punctuation">.</span>isAdministrator<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//  ~~~~~~~~~~~~~~~~~~~~</span>
    <span class="token comment">// error! This condition will always return true since the function is always defined.</span>
    <span class="token comment">//        Did you mean to call it instead?</span>
</code></pre></div><p>这个检查功能是一个破坏性变更，基于这个因素，检查会非常保守。
因此对这类错误的提示仅限于  <code>if</code>  条件语句中。当问题函数是可选属性、或未开启  <code>strictNullChecks</code>  选项、或该函数在  <code>if</code>  的代码块中有被调用，在这些情况下不会被视为错误：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">interface</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>
  <span class="token function">isAdministrator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
  <span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
  doNotDisturb<span class="token operator">?</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">issueNotification</span><span class="token punctuation">(</span>user<span class="token operator">:</span> User<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>user<span class="token punctuation">.</span>doNotDisturb<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// OK，属性是可选的</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>user<span class="token punctuation">.</span>notify<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// OK，调用了该函数</span>
    user<span class="token punctuation">.</span><span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>如果你打算对该函数进行测试但不调用它，你可以修改它的类型定义，让它可能是  <code>undefined</code> / <code>null</code> ，或使用  <code>!!</code>  来编写类似  <code>if (!!user.isAdministrator)</code>  的代码，表示代码逻辑确实是这样的。</p> <p>我们非常感谢社区成员 <a href="https://github.com/jwbay" target="_blank" rel="noopener noreferrer">@jwbay<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 提出了 <a href="https://github.com/microsoft/TypeScript/pull/32802" target="_blank" rel="noopener noreferrer">这个问题的概念<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 并持续跟进实现了 <a href="https://github.com/microsoft/TypeScript/pull/33178" target="_blank" rel="noopener noreferrer">这个需求的当前版本<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <h2 id="typescript-文件中的-ts-nocheck"><a href="#typescript-文件中的-ts-nocheck" class="header-anchor">#</a> TypeScript 文件中的  <code>// @ts-nocheck</code></h2> <p>TypeScript 3.7 允许我们在 TypeScript 文件的顶部添加一行  <code>// @ts-nocheck</code>  注释来关闭语义检查。
这个注释原本只在  <code>checkJs</code>  选项启用时的 JavaScript 源文件中有效，但我们扩展了它，让它能够支持 TypeScript 文件，这样所有使用者在迁移的时候会更方便。</p> <h2 id="分号格式化选项"><a href="#分号格式化选项" class="header-anchor">#</a> 分号格式化选项</h2> <p>JavaScript 有一个自动分号插入（ASI，automatic semicolon insertion）规则，TypeScript 内置的格式化程序现在能支持在可选的尾分号位置插入或删除分号。该设置现在在 <a href="https://code.visualstudio.com/insiders/" target="_blank" rel="noopener noreferrer">Visual Studio Code Insiders<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ，以及 Visual Studio 16.4 Preview 2 中的 “工具选项” 菜单中可用。</p> <img width="833" alt="New semicolon formatter option in VS Code" src="https://user-images.githubusercontent.com/3277153/65913194-10066e80-e395-11e9-8a3a-4f7305c397d5.png"> <p>将值设定为 “insert” 或 “remove” 同时也会影响自动导入、类型提取、以及其他 TypeScript 服务提供的自动生成代码的格式。将设置保留为默认值 “ignore” 可以使生成代码的分号自动配置匹配当前文件的风格。</p> <h2 id="_3-7-的破坏性变更"><a href="#_3-7-的破坏性变更" class="header-anchor">#</a> 3.7 的破坏性变更</h2> <h3 id="dom-变更"><a href="#dom-变更" class="header-anchor">#</a> DOM 变更</h3> <p><a href="https://github.com/microsoft/TypeScript/pull/33627" target="_blank" rel="noopener noreferrer"><code>lib.dom.d.ts</code>  中的类型声明已更新<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。
这些变更大部分是与空值检查有关的检测准确性变更，最终的影响取决于你的代码库。</p> <h3 id="类字段处理"><a href="#类字段处理" class="header-anchor">#</a> 类字段处理</h3> <p><a href="#usedefineforclassfields-%e7%bc%96%e8%af%91%e9%80%89%e9%a1%b9%e5%92%8c-declare-%e5%b1%9e%e6%80%a7%e4%bf%ae%e9%a5%b0%e7%ac%a6">正如上文提到的</a>，TypeScript 3.7 现在能够在  <code>.d.ts</code>  文件中编译出  <code>get</code> / <code>set</code> ，这可能对 3.5 和更低版本的 TypeScript 使用者来说是破坏性变更。
TypeScript 3.6 的使用者不会受影响，因为该版本对这个功能已经进行了预兼容。</p> <p><code>useDefineForClassFields</code>  选项虽然自身没有破坏性变更，但不排除以下情形：</p> <ul><li>在派生类中用属性声明覆盖了基类的访问器</li> <li>覆盖声明属性，但是没有初始值</li></ul> <p>要了解全部的影响，请查看 <a href="#usedefineforclassfields-%e7%bc%96%e8%af%91%e9%80%89%e9%a1%b9%e5%92%8c-declare-%e5%b1%9e%e6%80%a7%e4%bf%ae%e9%a5%b0%e7%ac%a6">上面关于  <code>useDefineForClassFields</code>  的章节</a>。</p> <h3 id="函数真值检查"><a href="#函数真值检查" class="header-anchor">#</a> 函数真值检查</h3> <p>正如上文提到的，现在当函数在  <code>if</code>  条件语句中未被调用时 TypeScript 会报错。
当  <code>if</code>  条件语句中判断的是函数时将会报错，除非符合以下情形：</p> <ul><li>该函数是可选属性</li> <li>未开启  <code>strictNullChecks</code>  选项</li> <li>该函数在  <code>if</code>  的代码块中有被调用</li></ul> <h3 id="本地和导入的类型声明现在会产生冲突"><a href="#本地和导入的类型声明现在会产生冲突" class="header-anchor">#</a> 本地和导入的类型声明现在会产生冲突</h3> <p>TypeScript 之前有一个 bug，导致允许以下代码结构：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// ./someOtherModule.ts</span>
<span class="token keyword">interface</span> <span class="token class-name">SomeType</span> <span class="token punctuation">{</span>
  y<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// ./myModule.ts</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> SomeType <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./someOtherModule'</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">SomeType</span> <span class="token punctuation">{</span>
  x<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span>arg<span class="token operator">:</span> SomeType<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arg<span class="token punctuation">.</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Error! 'x' doesn't exist on 'SomeType'</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这里， <code>SomeType</code>  同时来源于  <code>import</code>  声明和本地  <code>interface</code>  声明。
出人意料的是，在模块内部， <code>SomeType</code>  只会指向  <code>import</code>  的定义，而本地声明的  <code>SomeType</code>  仅在另一个文件的导入中起效。
这很令人困惑，我们对类似的个例进行的调查表明，广大开发者通常理解的情况不一样。</p> <p>在 TypeScript 3.7 中，<a href="https://github.com/microsoft/TypeScript/pull/31231" target="_blank" rel="noopener noreferrer">这个问题中的重复声明现在可以被正确地识别为一个错误<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。
合理的修复方案取决于开发者的原始意图，并应该逐案解决。
通常，命名冲突不是故意的，最好的办法是重命名导入的那个类型。
如果是要扩展导入的类型，则可以编写模块扩展（module augmentation）来代替。</p> <h3 id="_3-7-api-变化"><a href="#_3-7-api-变化" class="header-anchor">#</a> 3.7 API 变化</h3> <p>为了实现上文中提到的递归的类型别名模式， <code>TypeReference</code>  接口已经移除了  <code>typeArguments</code>  属性。开发者应该在  <code>TypeChecker</code>  实例上使用  <code>getTypeArguments</code>  函数来代替。</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/Typescript-manual/download/zh/release-notes/typescript-3.8.html" class="prev">
        TypeScript 3.8
      </a></span> <span class="next"><a href="/Typescript-manual/download/zh/release-notes/typescript-3.6.html">
        TypeScript 3.6
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/Typescript-manual/assets/js/app.1593970b.js" defer></script><script src="/Typescript-manual/assets/js/2.f0d70486.js" defer></script><script src="/Typescript-manual/assets/js/1.93812fe5.js" defer></script><script src="/Typescript-manual/assets/js/147.ac8ef52d.js" defer></script>
  </body>
</html>

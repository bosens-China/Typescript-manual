<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>TypeScript 5.0 | TypeScript手册</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/Typescript-manual/favicon.png">
    <meta name="description" content="TypeScript是JavaScript类型的超集，它可以编译成纯JavaScript。
  TypeScript可以在任何浏览器、任何计算机和任何操作系统上运行，并且是开源的。">
    <meta name="viewport" content="width=device-width, initial-scale=1.0,user-scalable=no, viewport-fit=cover">
    <meta name="keywords" content="typescript,docs,手册,文档">
    <meta name="author" content="boses">
    <meta name="google" content="notranslate">
    
    <link rel="preload" href="/Typescript-manual/assets/css/0.styles.237d6e09.css" as="style"><link rel="preload" href="/Typescript-manual/assets/js/app.1593970b.js" as="script"><link rel="preload" href="/Typescript-manual/assets/js/2.f0d70486.js" as="script"><link rel="preload" href="/Typescript-manual/assets/js/1.93812fe5.js" as="script"><link rel="preload" href="/Typescript-manual/assets/js/160.c6a27367.js" as="script"><link rel="prefetch" href="/Typescript-manual/assets/js/10.4762e221.js"><link rel="prefetch" href="/Typescript-manual/assets/js/100.d9e46ceb.js"><link rel="prefetch" href="/Typescript-manual/assets/js/101.b135bd55.js"><link rel="prefetch" href="/Typescript-manual/assets/js/102.eb03502d.js"><link rel="prefetch" href="/Typescript-manual/assets/js/103.6d45baa7.js"><link rel="prefetch" href="/Typescript-manual/assets/js/104.9282c1ea.js"><link rel="prefetch" href="/Typescript-manual/assets/js/105.7c026097.js"><link rel="prefetch" href="/Typescript-manual/assets/js/106.1a54e046.js"><link rel="prefetch" href="/Typescript-manual/assets/js/107.c7455d6c.js"><link rel="prefetch" href="/Typescript-manual/assets/js/108.9910413b.js"><link rel="prefetch" href="/Typescript-manual/assets/js/109.7326eb25.js"><link rel="prefetch" href="/Typescript-manual/assets/js/11.87c69216.js"><link rel="prefetch" href="/Typescript-manual/assets/js/110.cc92b634.js"><link rel="prefetch" href="/Typescript-manual/assets/js/111.040b77ba.js"><link rel="prefetch" href="/Typescript-manual/assets/js/112.e6fe143c.js"><link rel="prefetch" href="/Typescript-manual/assets/js/113.ae192573.js"><link rel="prefetch" href="/Typescript-manual/assets/js/114.fb65c1e1.js"><link rel="prefetch" href="/Typescript-manual/assets/js/115.c01cfbd6.js"><link rel="prefetch" href="/Typescript-manual/assets/js/116.02c6ca5f.js"><link rel="prefetch" href="/Typescript-manual/assets/js/117.66129e9d.js"><link rel="prefetch" href="/Typescript-manual/assets/js/118.6a1c9db2.js"><link rel="prefetch" href="/Typescript-manual/assets/js/119.e744a988.js"><link rel="prefetch" href="/Typescript-manual/assets/js/12.4babe899.js"><link rel="prefetch" href="/Typescript-manual/assets/js/120.795aa6be.js"><link rel="prefetch" href="/Typescript-manual/assets/js/121.577dd2ed.js"><link rel="prefetch" href="/Typescript-manual/assets/js/122.287b1f13.js"><link rel="prefetch" href="/Typescript-manual/assets/js/123.8043a050.js"><link rel="prefetch" href="/Typescript-manual/assets/js/124.7c6f56cf.js"><link rel="prefetch" href="/Typescript-manual/assets/js/125.c8a9a013.js"><link rel="prefetch" href="/Typescript-manual/assets/js/126.e64eccdd.js"><link rel="prefetch" href="/Typescript-manual/assets/js/127.3029a53e.js"><link rel="prefetch" href="/Typescript-manual/assets/js/128.654e2397.js"><link rel="prefetch" href="/Typescript-manual/assets/js/129.cb4fc6c0.js"><link rel="prefetch" href="/Typescript-manual/assets/js/13.5ab5050a.js"><link rel="prefetch" href="/Typescript-manual/assets/js/130.c6b9a006.js"><link rel="prefetch" href="/Typescript-manual/assets/js/131.1cebdbee.js"><link rel="prefetch" href="/Typescript-manual/assets/js/132.2620ecb5.js"><link rel="prefetch" href="/Typescript-manual/assets/js/133.7f53bf1f.js"><link rel="prefetch" href="/Typescript-manual/assets/js/134.129702c6.js"><link rel="prefetch" href="/Typescript-manual/assets/js/135.8f4d5357.js"><link rel="prefetch" href="/Typescript-manual/assets/js/136.e17df536.js"><link rel="prefetch" href="/Typescript-manual/assets/js/137.ff13fde2.js"><link rel="prefetch" href="/Typescript-manual/assets/js/138.fb3636c3.js"><link rel="prefetch" href="/Typescript-manual/assets/js/139.f8beedc3.js"><link rel="prefetch" href="/Typescript-manual/assets/js/14.7a250a11.js"><link rel="prefetch" href="/Typescript-manual/assets/js/140.3daa1308.js"><link rel="prefetch" href="/Typescript-manual/assets/js/141.bb090054.js"><link rel="prefetch" href="/Typescript-manual/assets/js/142.fed938ad.js"><link rel="prefetch" href="/Typescript-manual/assets/js/143.a3b29462.js"><link rel="prefetch" href="/Typescript-manual/assets/js/144.c09dd4b2.js"><link rel="prefetch" href="/Typescript-manual/assets/js/145.ffc8125a.js"><link rel="prefetch" href="/Typescript-manual/assets/js/146.743057fc.js"><link rel="prefetch" href="/Typescript-manual/assets/js/147.ac8ef52d.js"><link rel="prefetch" href="/Typescript-manual/assets/js/148.6d5e8ae5.js"><link rel="prefetch" href="/Typescript-manual/assets/js/149.341c6a4f.js"><link rel="prefetch" href="/Typescript-manual/assets/js/15.fd694870.js"><link rel="prefetch" href="/Typescript-manual/assets/js/150.31a051f2.js"><link rel="prefetch" href="/Typescript-manual/assets/js/151.a761bf9b.js"><link rel="prefetch" href="/Typescript-manual/assets/js/152.32ee780e.js"><link rel="prefetch" href="/Typescript-manual/assets/js/153.1e2f2b44.js"><link rel="prefetch" href="/Typescript-manual/assets/js/154.bc25bc22.js"><link rel="prefetch" href="/Typescript-manual/assets/js/155.fb17da55.js"><link rel="prefetch" href="/Typescript-manual/assets/js/156.651a9c2e.js"><link rel="prefetch" href="/Typescript-manual/assets/js/157.adca0669.js"><link rel="prefetch" href="/Typescript-manual/assets/js/158.a3abc67d.js"><link rel="prefetch" href="/Typescript-manual/assets/js/159.c2445408.js"><link rel="prefetch" href="/Typescript-manual/assets/js/16.a882cd43.js"><link rel="prefetch" href="/Typescript-manual/assets/js/161.b312e41a.js"><link rel="prefetch" href="/Typescript-manual/assets/js/162.3287bbbd.js"><link rel="prefetch" href="/Typescript-manual/assets/js/163.47be0007.js"><link rel="prefetch" href="/Typescript-manual/assets/js/164.210d1a22.js"><link rel="prefetch" href="/Typescript-manual/assets/js/165.7482c1f3.js"><link rel="prefetch" href="/Typescript-manual/assets/js/166.45c6e113.js"><link rel="prefetch" href="/Typescript-manual/assets/js/167.2eebcd57.js"><link rel="prefetch" href="/Typescript-manual/assets/js/168.b3d23364.js"><link rel="prefetch" href="/Typescript-manual/assets/js/169.c924ff86.js"><link rel="prefetch" href="/Typescript-manual/assets/js/17.76d6950f.js"><link rel="prefetch" href="/Typescript-manual/assets/js/170.03ef2fa9.js"><link rel="prefetch" href="/Typescript-manual/assets/js/171.34187668.js"><link rel="prefetch" href="/Typescript-manual/assets/js/172.635bb738.js"><link rel="prefetch" href="/Typescript-manual/assets/js/173.6bbe41b6.js"><link rel="prefetch" href="/Typescript-manual/assets/js/174.e442febc.js"><link rel="prefetch" href="/Typescript-manual/assets/js/175.41bb67ab.js"><link rel="prefetch" href="/Typescript-manual/assets/js/176.49120c59.js"><link rel="prefetch" href="/Typescript-manual/assets/js/177.c523f572.js"><link rel="prefetch" href="/Typescript-manual/assets/js/178.9423ebb2.js"><link rel="prefetch" href="/Typescript-manual/assets/js/179.dda7f960.js"><link rel="prefetch" href="/Typescript-manual/assets/js/18.cac3cb70.js"><link rel="prefetch" href="/Typescript-manual/assets/js/180.4dfba409.js"><link rel="prefetch" href="/Typescript-manual/assets/js/181.e4f017a7.js"><link rel="prefetch" href="/Typescript-manual/assets/js/182.547e085d.js"><link rel="prefetch" href="/Typescript-manual/assets/js/183.5acbdd59.js"><link rel="prefetch" href="/Typescript-manual/assets/js/19.04e9bc02.js"><link rel="prefetch" href="/Typescript-manual/assets/js/20.68aa1956.js"><link rel="prefetch" href="/Typescript-manual/assets/js/21.d9e46a4f.js"><link rel="prefetch" href="/Typescript-manual/assets/js/22.f23e5600.js"><link rel="prefetch" href="/Typescript-manual/assets/js/23.1a6c395d.js"><link rel="prefetch" href="/Typescript-manual/assets/js/24.c4122643.js"><link rel="prefetch" href="/Typescript-manual/assets/js/25.25881907.js"><link rel="prefetch" href="/Typescript-manual/assets/js/26.b5d956b1.js"><link rel="prefetch" href="/Typescript-manual/assets/js/27.ee846739.js"><link rel="prefetch" href="/Typescript-manual/assets/js/28.ba1574f7.js"><link rel="prefetch" href="/Typescript-manual/assets/js/29.32e60931.js"><link rel="prefetch" href="/Typescript-manual/assets/js/3.c0ad6938.js"><link rel="prefetch" href="/Typescript-manual/assets/js/30.3b6cd0b7.js"><link rel="prefetch" href="/Typescript-manual/assets/js/31.0a11a38c.js"><link rel="prefetch" href="/Typescript-manual/assets/js/32.f159c8e6.js"><link rel="prefetch" href="/Typescript-manual/assets/js/33.1ef243d1.js"><link rel="prefetch" href="/Typescript-manual/assets/js/34.f01c876d.js"><link rel="prefetch" href="/Typescript-manual/assets/js/35.8bfdb28b.js"><link rel="prefetch" href="/Typescript-manual/assets/js/36.fdd0ba51.js"><link rel="prefetch" href="/Typescript-manual/assets/js/37.3f218ce6.js"><link rel="prefetch" href="/Typescript-manual/assets/js/38.f8226620.js"><link rel="prefetch" href="/Typescript-manual/assets/js/39.e7d5d326.js"><link rel="prefetch" href="/Typescript-manual/assets/js/4.038d7f28.js"><link rel="prefetch" href="/Typescript-manual/assets/js/40.7a4cb0fe.js"><link rel="prefetch" href="/Typescript-manual/assets/js/41.494af996.js"><link rel="prefetch" href="/Typescript-manual/assets/js/42.304eae27.js"><link rel="prefetch" href="/Typescript-manual/assets/js/43.769a064a.js"><link rel="prefetch" href="/Typescript-manual/assets/js/44.9b36658c.js"><link rel="prefetch" href="/Typescript-manual/assets/js/45.1038e1df.js"><link rel="prefetch" href="/Typescript-manual/assets/js/46.65baf8d4.js"><link rel="prefetch" href="/Typescript-manual/assets/js/47.7b66616f.js"><link rel="prefetch" href="/Typescript-manual/assets/js/48.0e91f3a4.js"><link rel="prefetch" href="/Typescript-manual/assets/js/49.b7f1bb44.js"><link rel="prefetch" href="/Typescript-manual/assets/js/5.64774910.js"><link rel="prefetch" href="/Typescript-manual/assets/js/50.045dee0d.js"><link rel="prefetch" href="/Typescript-manual/assets/js/51.f4d25851.js"><link rel="prefetch" href="/Typescript-manual/assets/js/52.488e3de2.js"><link rel="prefetch" href="/Typescript-manual/assets/js/53.24bf50d9.js"><link rel="prefetch" href="/Typescript-manual/assets/js/54.2342813a.js"><link rel="prefetch" href="/Typescript-manual/assets/js/55.ba7136ba.js"><link rel="prefetch" href="/Typescript-manual/assets/js/56.34586136.js"><link rel="prefetch" href="/Typescript-manual/assets/js/57.55444e9b.js"><link rel="prefetch" href="/Typescript-manual/assets/js/58.6e7dd2c6.js"><link rel="prefetch" href="/Typescript-manual/assets/js/59.6907c3e4.js"><link rel="prefetch" href="/Typescript-manual/assets/js/6.cfb80da4.js"><link rel="prefetch" href="/Typescript-manual/assets/js/60.f7c33e9f.js"><link rel="prefetch" href="/Typescript-manual/assets/js/61.d887d15b.js"><link rel="prefetch" href="/Typescript-manual/assets/js/62.eeb4a1af.js"><link rel="prefetch" href="/Typescript-manual/assets/js/63.166ceb13.js"><link rel="prefetch" href="/Typescript-manual/assets/js/64.e5f91c57.js"><link rel="prefetch" href="/Typescript-manual/assets/js/65.f37d6448.js"><link rel="prefetch" href="/Typescript-manual/assets/js/66.67a6098b.js"><link rel="prefetch" href="/Typescript-manual/assets/js/67.98342e87.js"><link rel="prefetch" href="/Typescript-manual/assets/js/68.0eca9faa.js"><link rel="prefetch" href="/Typescript-manual/assets/js/69.accb09f1.js"><link rel="prefetch" href="/Typescript-manual/assets/js/7.3c60c652.js"><link rel="prefetch" href="/Typescript-manual/assets/js/70.df1bb896.js"><link rel="prefetch" href="/Typescript-manual/assets/js/71.65b4584b.js"><link rel="prefetch" href="/Typescript-manual/assets/js/72.5ad16533.js"><link rel="prefetch" href="/Typescript-manual/assets/js/73.222e0f4f.js"><link rel="prefetch" href="/Typescript-manual/assets/js/74.6d364488.js"><link rel="prefetch" href="/Typescript-manual/assets/js/75.f08ef413.js"><link rel="prefetch" href="/Typescript-manual/assets/js/76.06f71fc6.js"><link rel="prefetch" href="/Typescript-manual/assets/js/77.51c40296.js"><link rel="prefetch" href="/Typescript-manual/assets/js/78.e858e4ab.js"><link rel="prefetch" href="/Typescript-manual/assets/js/79.44e29644.js"><link rel="prefetch" href="/Typescript-manual/assets/js/80.b67dcf99.js"><link rel="prefetch" href="/Typescript-manual/assets/js/81.b7cea060.js"><link rel="prefetch" href="/Typescript-manual/assets/js/82.6441a0a3.js"><link rel="prefetch" href="/Typescript-manual/assets/js/83.03f2f860.js"><link rel="prefetch" href="/Typescript-manual/assets/js/84.070382e8.js"><link rel="prefetch" href="/Typescript-manual/assets/js/85.7a10baf5.js"><link rel="prefetch" href="/Typescript-manual/assets/js/86.52448263.js"><link rel="prefetch" href="/Typescript-manual/assets/js/87.3e28b70e.js"><link rel="prefetch" href="/Typescript-manual/assets/js/88.ac603069.js"><link rel="prefetch" href="/Typescript-manual/assets/js/89.d8fc6c9d.js"><link rel="prefetch" href="/Typescript-manual/assets/js/90.061b7bae.js"><link rel="prefetch" href="/Typescript-manual/assets/js/91.085c8066.js"><link rel="prefetch" href="/Typescript-manual/assets/js/92.f91f3791.js"><link rel="prefetch" href="/Typescript-manual/assets/js/93.222df328.js"><link rel="prefetch" href="/Typescript-manual/assets/js/94.a419988b.js"><link rel="prefetch" href="/Typescript-manual/assets/js/95.ab410dec.js"><link rel="prefetch" href="/Typescript-manual/assets/js/96.d094c11b.js"><link rel="prefetch" href="/Typescript-manual/assets/js/97.a32b936b.js"><link rel="prefetch" href="/Typescript-manual/assets/js/98.86d54546.js"><link rel="prefetch" href="/Typescript-manual/assets/js/99.fe0b2436.js"><link rel="prefetch" href="/Typescript-manual/assets/js/vendors~docsearch.8e5b54b3.js">
    <link rel="stylesheet" href="/Typescript-manual/assets/css/0.styles.237d6e09.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/Typescript-manual/" class="home-link router-link-active"><!----> <span class="site-name">TypeScript手册</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/Typescript-manual/describe/" class="nav-link">
  进入目录
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="友情链接菜单" class="dropdown-title"><span class="title">友情链接</span> <span class="arrow down"></span></button> <button type="button" aria-label="友情链接菜单" class="mobile-dropdown-title"><span class="title">友情链接</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://jkchao.github.io/typescript-book-chinese/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  深入理解 TypeScript
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://ts.xcatliu.com/introduction/hello-typescript" target="_blank" rel="noopener noreferrer" class="nav-link external">
  hello-typescript
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="http://www.typescriptlang.org/docs/home.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  TypeScript手册（英文版）
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/Microsoft/TypeScript/blob/master/doc/spec.md" target="_blank" rel="noopener noreferrer" class="nav-link external">
  TypeScript语言规范
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/zhongsp/TypeScript/blob/master/CONTRIBUTING.md" target="_blank" rel="noopener noreferrer" class="nav-link external">
  参与贡献
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="https://github.com/bosens-China/Typescript-manual" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/bosens-China/Typescript-manual/issues" target="_blank" rel="noopener noreferrer" class="nav-link external">
  问题反馈
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/Typescript-manual/describe/" class="nav-link">
  进入目录
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="友情链接菜单" class="dropdown-title"><span class="title">友情链接</span> <span class="arrow down"></span></button> <button type="button" aria-label="友情链接菜单" class="mobile-dropdown-title"><span class="title">友情链接</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://jkchao.github.io/typescript-book-chinese/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  深入理解 TypeScript
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://ts.xcatliu.com/introduction/hello-typescript" target="_blank" rel="noopener noreferrer" class="nav-link external">
  hello-typescript
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="http://www.typescriptlang.org/docs/home.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  TypeScript手册（英文版）
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/Microsoft/TypeScript/blob/master/doc/spec.md" target="_blank" rel="noopener noreferrer" class="nav-link external">
  TypeScript语言规范
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/zhongsp/TypeScript/blob/master/CONTRIBUTING.md" target="_blank" rel="noopener noreferrer" class="nav-link external">
  参与贡献
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="https://github.com/bosens-China/Typescript-manual" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/bosens-China/Typescript-manual/issues" target="_blank" rel="noopener noreferrer" class="nav-link external">
  问题反馈
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/Typescript-manual/describe/" class="sidebar-link">前言</a></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>快速上手</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Typescript-manual/download/zh/tutorials/typescript-in-5-minutes.html" class="sidebar-link">5 分钟了解 TypeScript</a></li><li><a href="/Typescript-manual/download/zh/tutorials/asp.net-core.html" class="sidebar-link">ASP.NET Core</a></li><li><a href="/Typescript-manual/download/zh/tutorials/asp.net-4.html" class="sidebar-link">ASP.NET 4</a></li><li><a href="/Typescript-manual/download/zh/tutorials/gulp.html" class="sidebar-link">Gulp</a></li><li><a href="/Typescript-manual/download/zh/tutorials/knockout.html" class="sidebar-link">Knockout.js</a></li><li><a href="/Typescript-manual/download/zh/tutorials/react-and-webpack.html" class="sidebar-link">React 与 webpack</a></li><li><a href="/Typescript-manual/download/zh/tutorials/react.html" class="sidebar-link">React</a></li><li><a href="/Typescript-manual/download/zh/tutorials/angular-2.html" class="sidebar-link">Angular 2</a></li><li><a href="/Typescript-manual/download/zh/tutorials/migrating-from-javascript.html" class="sidebar-link">从 JavaScript 迁移到 TypeScript</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>手册</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Typescript-manual/download/zh/handbook/basic-types.html" class="sidebar-link">基础类型</a></li><li><a href="/Typescript-manual/download/zh/handbook/interfaces.html" class="sidebar-link">接口</a></li><li><a href="/Typescript-manual/download/zh/handbook/functions.html" class="sidebar-link">函数</a></li><li><a href="/Typescript-manual/download/zh/handbook/literal-types.html" class="sidebar-link">字面量类型</a></li><li><a href="/Typescript-manual/download/zh/handbook/unions-and-intersections.html" class="sidebar-link">联合类型和交叉类型</a></li><li><a href="/Typescript-manual/download/zh/handbook/classes.html" class="sidebar-link">类</a></li><li><a href="/Typescript-manual/download/zh/handbook/enums.html" class="sidebar-link">枚举</a></li><li><a href="/Typescript-manual/download/zh/handbook/generics.html" class="sidebar-link">泛型</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>手册（进阶）</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Typescript-manual/download/zh/reference/advanced-types.html" class="sidebar-link">高级类型</a></li><li><a href="/Typescript-manual/download/zh/reference/utility-types.html" class="sidebar-link">实用工具类型</a></li><li><a href="/Typescript-manual/download/zh/reference/decorators.html" class="sidebar-link">Decorators</a></li><li><a href="/Typescript-manual/download/zh/reference/declaration-merging.html" class="sidebar-link">声明合并</a></li><li><a href="/Typescript-manual/download/zh/reference/iterators-and-generators.html" class="sidebar-link">Iterators 和 Generators</a></li><li><a href="/Typescript-manual/download/zh/reference/jsx.html" class="sidebar-link">JSX</a></li><li><a href="/Typescript-manual/download/zh/reference/mixins.html" class="sidebar-link">混入</a></li><li><a href="/Typescript-manual/download/zh/reference/modules.html" class="sidebar-link">模块</a></li><li><a href="/Typescript-manual/download/zh/reference/module-resolution.html" class="sidebar-link">模块解析</a></li><li><a href="/Typescript-manual/download/zh/reference/namespaces.html" class="sidebar-link">命名空间</a></li><li><a href="/Typescript-manual/download/zh/reference/namespaces-and-modules.html" class="sidebar-link">命名空间和模块</a></li><li><a href="/Typescript-manual/download/zh/reference/symbols.html" class="sidebar-link">Symbols</a></li><li><a href="/Typescript-manual/download/zh/reference/triple-slash-directives.html" class="sidebar-link">三斜线指令</a></li><li><a href="/Typescript-manual/download/zh/reference/type-compatibility.html" class="sidebar-link">类型兼容性</a></li><li><a href="/Typescript-manual/download/zh/reference/type-inference.html" class="sidebar-link">类型推论</a></li><li><a href="/Typescript-manual/download/zh/reference/variable-declarations.html" class="sidebar-link">变量声明</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>手册（v2）
</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Typescript-manual/download/zh/handbook-v2/type-manipulation/template-literal-types.html" class="sidebar-link">模版字面量类型</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>如何书写声明文件</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Typescript-manual/download/zh/declaration-files/introduction.html" class="sidebar-link">介绍</a></li><li><a href="/Typescript-manual/download/zh/declaration-files/by-example.html" class="sidebar-link">举例</a></li><li><a href="/Typescript-manual/download/zh/declaration-files/library-structures.html" class="sidebar-link">库结构</a></li><li><a href="/Typescript-manual/download/zh/declaration-files/templates.html" class="sidebar-link">模板</a></li><li><a href="/Typescript-manual/download/zh/declaration-files/do-s-and-don-ts.html" class="sidebar-link">最佳实践</a></li><li><a href="/Typescript-manual/download/zh/declaration-files/deep-dive.html" class="sidebar-link">深入</a></li><li><a href="/Typescript-manual/download/zh/declaration-files/publishing.html" class="sidebar-link">发布</a></li><li><a href="/Typescript-manual/download/zh/declaration-files/consumption.html" class="sidebar-link">使用</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>JavaScript
</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Typescript-manual/download/zh/javascript/type-checking-javascript-files.html" class="sidebar-link">JavaScript 文件里的类型检查</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>工程配置</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Typescript-manual/download/zh/project-config/tsconfig.json.html" class="sidebar-link">tsconfig.json</a></li><li><a href="/Typescript-manual/download/zh/project-config/project-references.html" class="sidebar-link">工程引用</a></li><li><a href="/Typescript-manual/download/zh/project-config/typings-for-npm-packages.html" class="sidebar-link">NPM 包的类型</a></li><li><a href="/Typescript-manual/download/zh/project-config/compiler-options.html" class="sidebar-link">编译选项</a></li><li><a href="/Typescript-manual/download/zh/project-config/configuring-watch.html" class="sidebar-link">配置 Watch</a></li><li><a href="/Typescript-manual/download/zh/project-config/compiler-options-in-msbuild.html" class="sidebar-link">在 MSBuild 里使用编译选项</a></li><li><a href="/Typescript-manual/download/zh/project-config/integrating-with-build-tools.html" class="sidebar-link">与其它构建工具整合</a></li><li><a href="/Typescript-manual/download/zh/project-config/nightly-builds.html" class="sidebar-link">使用 TypeScript 的每日构建版本</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Wiki</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Typescript-manual/download/zh/wiki/this-in-typescript.html" class="sidebar-link">TypeScript 里的 this</a></li><li><a href="/Typescript-manual/download/zh/wiki/coding_guidelines.html" class="sidebar-link">编码规范</a></li><li><a href="/Typescript-manual/download/zh/wiki/common-errors.html" class="sidebar-link">常见编译错误</a></li><li><a href="/Typescript-manual/download/zh/wiki/typescript-editor-support.html" class="sidebar-link">支持 TypeScript 的编辑器</a></li><li><a href="/Typescript-manual/download/zh/wiki/using-typescript-with-asp.net-5.html" class="sidebar-link">结合 ASP.NET v5 使用 TypeScript</a></li><li><a href="/Typescript-manual/download/zh/wiki/architectural-overview.html" class="sidebar-link">架构概述</a></li><li><a href="/Typescript-manual/download/zh/wiki/roadmap.html" class="sidebar-link">发展路线图</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>新增功能</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Typescript-manual/download/zh/release-notes/typescript-5.7.html" class="sidebar-link">TypeScript 5.7</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-5.6.html" class="sidebar-link">TypeScript 5.6</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-5.5.html" class="sidebar-link">TypeScript 5.5</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-5.4.html" class="sidebar-link">TypeScript 5.4</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-5.3.html" class="sidebar-link">TypeScript 5.3</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-5.2.html" class="sidebar-link">TypeScript 5.2</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-5.1.html" class="sidebar-link">TypeScript 5.1</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-5.0.html" aria-current="page" class="active sidebar-link">TypeScript 5.0</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Typescript-manual/download/zh/release-notes/typescript-5.0.html#装饰器-decorators" class="sidebar-link">装饰器 Decorators</a></li><li class="sidebar-sub-header"><a href="/Typescript-manual/download/zh/release-notes/typescript-5.0.html#与旧的实验性的装饰器的差异" class="sidebar-link">与旧的实验性的装饰器的差异</a></li><li class="sidebar-sub-header"><a href="/Typescript-manual/download/zh/release-notes/typescript-5.0.html#编写强类型的装饰器" class="sidebar-link">编写强类型的装饰器</a></li><li class="sidebar-sub-header"><a href="/Typescript-manual/download/zh/release-notes/typescript-5.0.html#const-类型参数" class="sidebar-link">const 类型参数</a></li><li class="sidebar-sub-header"><a href="/Typescript-manual/download/zh/release-notes/typescript-5.0.html#extends-支持多个配置文件" class="sidebar-link">extends 支持多个配置文件</a></li><li class="sidebar-sub-header"><a href="/Typescript-manual/download/zh/release-notes/typescript-5.0.html#所有的-enum-均为联合-enum" class="sidebar-link">所有的 enum 均为联合 enum</a></li><li class="sidebar-sub-header"><a href="/Typescript-manual/download/zh/release-notes/typescript-5.0.html#moduleresolution-bundler" class="sidebar-link">--moduleResolution bundler</a></li><li class="sidebar-sub-header"><a href="/Typescript-manual/download/zh/release-notes/typescript-5.0.html#定制化解析的标记" class="sidebar-link">定制化解析的标记</a></li><li class="sidebar-sub-header"><a href="/Typescript-manual/download/zh/release-notes/typescript-5.0.html#verbatimmodulesyntax" class="sidebar-link">--verbatimModuleSyntax</a></li><li class="sidebar-sub-header"><a href="/Typescript-manual/download/zh/release-notes/typescript-5.0.html#支持-export-type" class="sidebar-link">支持 export type *</a></li><li class="sidebar-sub-header"><a href="/Typescript-manual/download/zh/release-notes/typescript-5.0.html#支持-jsdoc-中的-satisfies" class="sidebar-link">支持 JSDoc 中的 @satisfies</a></li><li class="sidebar-sub-header"><a href="/Typescript-manual/download/zh/release-notes/typescript-5.0.html#支持-jsdoc-中的-overload" class="sidebar-link">支持 JSDoc 中的 @overload</a></li><li class="sidebar-sub-header"><a href="/Typescript-manual/download/zh/release-notes/typescript-5.0.html#在-build-模式下使用有关文件生成的选项" class="sidebar-link">在 --build 模式下使用有关文件生成的选项</a></li><li class="sidebar-sub-header"><a href="/Typescript-manual/download/zh/release-notes/typescript-5.0.html#编辑器导入语句排序时不区分大小写" class="sidebar-link">编辑器导入语句排序时不区分大小写</a></li><li class="sidebar-sub-header"><a href="/Typescript-manual/download/zh/release-notes/typescript-5.0.html#穷举式-switch-case-自动补全" class="sidebar-link">穷举式 switch/case 自动补全</a></li><li class="sidebar-sub-header"><a href="/Typescript-manual/download/zh/release-notes/typescript-5.0.html#速度-内存以及代码包尺寸优化" class="sidebar-link">速度，内存以及代码包尺寸优化</a></li></ul></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-4.9.html" class="sidebar-link">TypeScript 4.9</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-4.8.html" class="sidebar-link">TypeScript 4.8</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-4.7.html" class="sidebar-link">TypeScript 4.7</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-4.6.html" class="sidebar-link">TypeScript 4.6</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-4.5.html" class="sidebar-link">TypeScript 4.5</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-4.4.html" class="sidebar-link">TypeScript 4.4</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-4.3.html" class="sidebar-link">TypeScript 4.3</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-4.2.html" class="sidebar-link">TypeScript 4.2</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-4.1.html" class="sidebar-link">TypeScript 4.1</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-4.0.html" class="sidebar-link">TypeScript 4.0</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-3.9.html" class="sidebar-link">TypeScript 3.9</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-3.8.html" class="sidebar-link">TypeScript 3.8</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-3.7.html" class="sidebar-link">TypeScript 3.7</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-3.6.html" class="sidebar-link">TypeScript 3.6</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-3.5.html" class="sidebar-link">TypeScript 3.5</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-3.4.html" class="sidebar-link">TypeScript 3.4</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-3.3.html" class="sidebar-link">TypeScript 3.3</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-3.2.html" class="sidebar-link">TypeScript 3.2</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-3.1.html" class="sidebar-link">TypeScript 3.1</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-3.0.html" class="sidebar-link">TypeScript 3.0</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-2.9.html" class="sidebar-link">TypeScript 2.9</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-2.8.html" class="sidebar-link">TypeScript 2.8</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-2.7.html" class="sidebar-link">TypeScript 2.7</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-2.6.html" class="sidebar-link">TypeScript 2.6</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-2.5.html" class="sidebar-link">TypeScript 2.5</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-2.4.html" class="sidebar-link">TypeScript 2.4</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-2.3.html" class="sidebar-link">TypeScript 2.3</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-2.2.html" class="sidebar-link">TypeScript 2.2</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-2.1.html" class="sidebar-link">TypeScript 2.1</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-2.0.html" class="sidebar-link">TypeScript 2.0</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-1.8.html" class="sidebar-link">TypeScript 1.8</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-1.7.html" class="sidebar-link">TypeScript 1.7</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-1.6.html" class="sidebar-link">TypeScript 1.6</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-1.5.html" class="sidebar-link">TypeScript 1.5</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-1.4.html" class="sidebar-link">TypeScript 1.4</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-1.3.html" class="sidebar-link">TypeScript 1.3</a></li><li><a href="/Typescript-manual/download/zh/release-notes/typescript-1.1.html" class="sidebar-link">TypeScript 1.1</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Breaking Changes</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Typescript-manual/download/zh/breaking-changes/typescript-3.6.html" class="sidebar-link">TypeScript 3.6</a></li><li><a href="/Typescript-manual/download/zh/breaking-changes/typescript-3.5.html" class="sidebar-link">TypeScript 3.5</a></li><li><a href="/Typescript-manual/download/zh/breaking-changes/typescript-3.4.html" class="sidebar-link">TypeScript 3.4</a></li><li><a href="/Typescript-manual/download/zh/breaking-changes/typescript-3.2.html" class="sidebar-link">TypeScript 3.2</a></li><li><a href="/Typescript-manual/download/zh/breaking-changes/typescript-3.1.html" class="sidebar-link">TypeScript 3.1</a></li><li><a href="/Typescript-manual/download/zh/breaking-changes/typescript-3.0.html" class="sidebar-link">TypeScript 3.0</a></li><li><a href="/Typescript-manual/download/zh/breaking-changes/typescript-2.9.html" class="sidebar-link">TypeScript 2.9</a></li><li><a href="/Typescript-manual/download/zh/breaking-changes/typescript-2.8.html" class="sidebar-link">TypeScript 2.8</a></li><li><a href="/Typescript-manual/download/zh/breaking-changes/typescript-2.7.html" class="sidebar-link">TypeScript 2.7</a></li><li><a href="/Typescript-manual/download/zh/breaking-changes/typescript-2.6.html" class="sidebar-link">TypeScript 2.6</a></li><li><a href="/Typescript-manual/download/zh/breaking-changes/typescript-2.4.html" class="sidebar-link">TypeScript 2.4</a></li><li><a href="/Typescript-manual/download/zh/breaking-changes/typescript-2.3.html" class="sidebar-link">TypeScript 2.3</a></li><li><a href="/Typescript-manual/download/zh/breaking-changes/typescript-2.2.html" class="sidebar-link">TypeScript 2.2</a></li><li><a href="/Typescript-manual/download/zh/breaking-changes/typescript-2.1.html" class="sidebar-link">TypeScript 2.1</a></li><li><a href="/Typescript-manual/download/zh/breaking-changes/typescript-2.0.html" class="sidebar-link">TypeScript 2.0</a></li><li><a href="/Typescript-manual/download/zh/breaking-changes/typescript-1.8.html" class="sidebar-link">TypeScript 1.8</a></li><li><a href="/Typescript-manual/download/zh/breaking-changes/typescript-1.7.html" class="sidebar-link">TypeScript 1.7</a></li><li><a href="/Typescript-manual/download/zh/breaking-changes/typescript-1.6.html" class="sidebar-link">TypeScript 1.6</a></li><li><a href="/Typescript-manual/download/zh/breaking-changes/typescript-1.5.html" class="sidebar-link">TypeScript 1.5</a></li><li><a href="/Typescript-manual/download/zh/breaking-changes/typescript-1.4.html" class="sidebar-link">TypeScript 1.4</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="typescript-5-0"><a href="#typescript-5-0" class="header-anchor">#</a> TypeScript 5.0</h1> <h2 id="装饰器-decorators"><a href="#装饰器-decorators" class="header-anchor">#</a> 装饰器 Decorators</h2> <p>装饰器是即将到来的 ECMAScript 特性，它允许我们定制可重用的类以及类成员。</p> <p>考虑如下的代码：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span>name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">greet</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Hello, my name is </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">'Ron'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
p<span class="token punctuation">.</span><span class="token function">greet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>这里的  <code>greet</code>  很简单，但我们假设它很复杂 - 例如包含异步的逻辑，是递归的，具有副作用等。
不管你把它想像成多么混乱复杂，现在我们想插入一些  <code>console.log</code>  语句来调试  <code>greet</code> 。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span>name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">greet</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'LOG: Entering method.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Hello, my name is </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'LOG: Exiting method.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这个做法太常见了。
如果有种办法能给每一个类方法都添加打印功能就太好了！</p> <p>这就是装饰器的用武之地。
让我们编写一个函数  <code>loggedMethod</code> ：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">loggedMethod</span><span class="token punctuation">(</span>originalMethod<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> _context<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token function">replacementMethod</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> <span class="token operator">...</span>args<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'LOG: Entering method.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token function">originalMethod</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token operator">...</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'LOG: Exiting method.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> replacementMethod<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>&quot; 这些  <code>any</code>  是怎么回事？都啥啊？&quot;</p> <p>先别急 - 这里我们是想简化一下问题，将注意力集中在函数的功能上。
注意一下  <code>loggedMethod</code>  接收原方法（ <code>originalMethod</code> ）作为参数并返回一个函数：</p> <ol><li>打印  <code>&quot;Entering…&quot;</code>  消息</li> <li>将  <code>this</code>  值以及所有的参数传递给原方法</li> <li>打印  <code>&quot;Exiting...&quot;</code>  消息，并且</li> <li>返回原方法的返回值。</li></ol> <p>现在可以使用  <code>loggedMethod</code>  来<em>装饰</em> <code>greet</code>  方法：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span>name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">loggedMethod</span></span>
  <span class="token function">greet</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Hello, my name is </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">'Ron'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
p<span class="token punctuation">.</span><span class="token function">greet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 输出:</span>
<span class="token comment">//</span>
<span class="token comment">//   LOG: Entering method.</span>
<span class="token comment">//   Hello, my name is Ron.</span>
<span class="token comment">//   LOG: Exiting method.</span>
</code></pre></div><p>我们刚刚在  <code>greet</code>  上使用了  <code>loggedMethod</code>  装饰器 - 注意一下写法  <code>@loggedMethod</code> 。
这样做之后， <code>loggedMethod</code>  被调用时会传入被装饰的目标  <code>target</code>  以及一个上下文对象  <code>context object</code>  作为参数。
因为  <code>loggedMethod</code>  返回了一个新函数，因此这个新函数会替换掉  <code>greet</code>  的原始定义。</p> <p>在  <code>loggedMethod</code>  的定义中带有第二个参数。
它就是上下文对象  <code>context object</code> ，包含了一些有关于装饰器声明细节的有用信息 -
 例如是否为  <code>#private</code>  成员，或者  <code>static</code> ，或者方法的名称。
让我们重写  <code>loggedMethod</code>  来使用这些信息，并且打印出被装饰的方法的名字。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">loggedMethod</span><span class="token punctuation">(</span>
  originalMethod<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span>
  context<span class="token operator">:</span> ClassMethodDecoratorContext
<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> methodName <span class="token operator">=</span> <span class="token function">String</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">function</span> <span class="token function">replacementMethod</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> <span class="token operator">...</span>args<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">LOG: Entering method '</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>methodName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">'.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token function">originalMethod</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token operator">...</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">LOG: Exiting method '</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>methodName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">'.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> replacementMethod<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>我们使用了上下文参数。
TypeScript 提供了名为  <code>ClassMethodDecoratorContext</code>  的类型用于描述装饰器方法接收的上下文对象。</p> <p>除了元数据外，上下文对象中还提供了一个有用的函数  <code>addInitializer</code> 。
它提供了一种方式来 hook 到构造函数的起始位置。</p> <p>例如在 JavaScript 中，下面的情形很常见：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span>name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span>greet <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">greet</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">greet</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Hello, my name is </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>或者， <code>greet</code>  可以被声明为使用箭头函数初始化的属性。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span>name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function-variable function">greet</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Hello, my name is </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这类代码的目的是确保  <code>this</code>  值不会被重新绑定，当  <code>greet</code>  被独立地调用或者在用作回调函数时。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> greet <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">'Ron'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>greet<span class="token punctuation">;</span>

<span class="token comment">// 我们不希望下面的调用失败</span>
<span class="token function">greet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>我们可以定义一个装饰器来利用  <code>addInitializer</code>  在构造函数里调用  <code>bind</code> 。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">bound</span><span class="token punctuation">(</span>originalMethod<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> context<span class="token operator">:</span> ClassMethodDecoratorContext<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> methodName <span class="token operator">=</span> context<span class="token punctuation">.</span>name<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>context<span class="token punctuation">.</span>private<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span>
      <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">'bound' cannot decorate private properties like </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>methodName <span class="token keyword">as</span> <span class="token builtin">string</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.</span><span class="token template-punctuation string">`</span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  context<span class="token punctuation">.</span><span class="token function">addInitializer</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">[</span>methodName<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">[</span>methodName<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>bound</code>  没有返回值 - 因此当它装饰一个方法时，不会影响原先的方法。
但是，它会在字段被初始化前添加一些逻辑。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span>name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">bound</span></span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">loggedMethod</span></span>
  <span class="token function">greet</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Hello, my name is </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">'Ron'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> greet <span class="token operator">=</span> p<span class="token punctuation">.</span>greet<span class="token punctuation">;</span>

<span class="token comment">// Works!</span>
<span class="token function">greet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>我们将两个装饰器叠在了一起 -  <code>@bound</code>  和  <code>@loggedMethod</code> 。
这些装饰器以 “相反的” 顺序执行。
也就是说， <code>@loggedMethod</code>  装饰原始方法  <code>greet</code> ，
 <code>@bound</code>  装饰的是  <code>@loggedMethod</code>  的结果。
此例中，这不太重要 - 但如果你的装饰器带有副作用或者期望特定的顺序，那就不一样了。</p> <p>值得注意的是：如果你在乎代码样式，也可以将装饰器放在同一行上。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token decorator"><span class="token at operator">@</span><span class="token function">bound</span></span> <span class="token decorator"><span class="token at operator">@</span><span class="token function">loggedMethod</span></span> <span class="token function">greet</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Hello, my name is </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>可能不太明显的一点是，你甚至可以定义一个返回装饰器函数的函数。
这样我们可以在一定程序上定制最终的装饰器。
我们可以让  <code>loggedMethod</code>  返回一个装饰器并且定制如何打印消息。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">loggedMethod</span><span class="token punctuation">(</span>headMessage <span class="token operator">=</span> <span class="token string">'LOG:'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token function">actualDecorator</span><span class="token punctuation">(</span>
    originalMethod<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span>
    context<span class="token operator">:</span> ClassMethodDecoratorContext
  <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> methodName <span class="token operator">=</span> <span class="token function">String</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">function</span> <span class="token function">replacementMethod</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> <span class="token operator">...</span>args<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>headMessage<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> Entering method '</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>methodName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">'.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token function">originalMethod</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token operator">...</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>headMessage<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> Exiting method '</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>methodName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">'.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> replacementMethod<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这样做之后，在使用  <code>loggedMethod</code>  装饰器之前需要先调用它。
接下来就可以传入任意字符串作为打印消息的前缀。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span>name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">loggedMethod</span></span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>
  <span class="token function">greet</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Hello, my name is </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">'Ron'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
p<span class="token punctuation">.</span><span class="token function">greet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Output:</span>
<span class="token comment">//</span>
<span class="token comment">//    Entering method 'greet'.</span>
<span class="token comment">//   Hello, my name is Ron.</span>
<span class="token comment">//    Exiting method 'greet'.</span>
</code></pre></div><p>装饰器不仅可以用在方法上！
它们也可以被用在属性 / 字段，存取器（getter/setter）以及自动存取器。
甚至，类本身也可以被装饰，用于处理子类化和注册。</p> <p>想深入了解装饰器，可以阅读 Axel Rauschmayer 的<a href="https://2ality.com/2022/10/javascript-decorators.html" target="_blank" rel="noopener noreferrer">文章<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <p>更多详情请参考 <a href="https://github.com/microsoft/TypeScript/pull/50820" target="_blank" rel="noopener noreferrer">PR<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <h2 id="与旧的实验性的装饰器的差异"><a href="#与旧的实验性的装饰器的差异" class="header-anchor">#</a> 与旧的实验性的装饰器的差异</h2> <p>如果你有一定的 TypeScript 经验，你会发现 TypeScript 多年前就已经支持了 “实验性的” 装饰器特性。
虽然实验性的装饰器非常地好用，但是它实现的是旧版本的装饰器规范，并且总是需要启用  <code>--experimentalDecorators</code>  编译器选项。
若没有启用它并且使用了装饰器，TypeScript 会报错。</p> <p>在未来的一段时间内， <code>--experimentalDecorators</code>  依然会存在；
然而，如果不使用该标记，在新代码中装饰器语法也是合法的。
在  <code>--experimentalDecorators</code>  之外，它们的类型检查和代码生成方式也不同。
类型检查和代码生成规则存在巨大差异，以至于虽然装饰器<em>可以</em>被定义为同时支持新、旧装饰器的行为，但任何现有的装饰器函数都不太可能这样做。</p> <p>新的装饰器提案与  <code>--emitDecoratorMetadata</code>  的实现不兼容，并且不支持在参数上使用装饰器。
未来的 ECMAScript 提案可能会弥补这个差距。</p> <p>最后要注意的是：除了可以在  <code>export</code>  关键字之前使用装饰器，还可以在  <code>export</code>  或者  <code>export default</code>  之后使用。
但是不允许混合使用两种风格。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">//  allowed</span>
<span class="token decorator"><span class="token at operator">@</span><span class="token function">register</span></span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">Foo</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>

<span class="token comment">//  also allowed</span>
<span class="token keyword">export</span> <span class="token keyword">default</span>
<span class="token decorator"><span class="token at operator">@</span><span class="token function">register</span></span>
<span class="token keyword">class</span> <span class="token class-name">Bar</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>

<span class="token comment">//  error - before *and* after is not allowed</span>
<span class="token decorator"><span class="token at operator">@</span><span class="token function">before</span></span>
<span class="token decorator"><span class="token at operator">@</span><span class="token function">after</span></span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Bar</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="编写强类型的装饰器"><a href="#编写强类型的装饰器" class="header-anchor">#</a> 编写强类型的装饰器</h2> <p>上面的例子  <code>loggedMethod</code>  和  <code>bound</code>  是故意写的简单并且忽略了大量和类型有关的细节。</p> <p>为装饰器添加类型可能会很复杂。
例如，强类型的  <code>loggedMethod</code>  可能像下面这样：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token generic-function"><span class="token function">loggedMethod</span><span class="token generic class-name"><span class="token operator">&lt;</span>This<span class="token punctuation">,</span> Args <span class="token keyword">extends</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> Return<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>
  <span class="token function-variable function">target</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">:</span> This<span class="token punctuation">,</span> <span class="token operator">...</span>args<span class="token operator">:</span> Args<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Return<span class="token punctuation">,</span>
  context<span class="token operator">:</span> ClassMethodDecoratorContext<span class="token operator">&lt;</span>
    This<span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">:</span> This<span class="token punctuation">,</span> <span class="token operator">...</span>args<span class="token operator">:</span> Args<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Return
  <span class="token operator">&gt;</span>
<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> methodName <span class="token operator">=</span> <span class="token function">String</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">function</span> <span class="token function">replacementMethod</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">:</span> This<span class="token punctuation">,</span> <span class="token operator">...</span>args<span class="token operator">:</span> Args<span class="token punctuation">)</span><span class="token operator">:</span> Return <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">LOG: Entering method '</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>methodName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">'.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token function">target</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token operator">...</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">LOG: Exiting method '</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>methodName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">'.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> replacementMethod<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>我们必须分别给原方法的  <code>this</code> 、形式参数和返回值添加类型，上面使用了类型参数  <code>This</code> ， <code>Args</code>  以及  <code>Return</code> 。
装饰器函数到底有多复杂取决于你要确保什么。
但要记住，装饰器被使用的次数远多于被编写的次数，因此强类型的版本是通常希望得到的 -
 但我们需要在可读性之间做出取舍，因此要尽量保持简洁。</p> <p>未来会有更多关于如何编写装饰器的文档 - 但是<a href="https://2ality.com/2022/10/javascript-decorators.html" target="_blank" rel="noopener noreferrer">这篇文章<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>详细介绍了装饰器的工作方式。</p> <h2 id="const-类型参数"><a href="#const-类型参数" class="header-anchor">#</a> <code>const</code>  类型参数</h2> <p>在推断对象类型时，TypeScript 通常会选择一个通用类型。
例如，下例中  <code>names</code>  的推断类型为  <code>string[]</code> ：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">type</span> <span class="token class-name">HasNames</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token keyword">readonly</span> names<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token generic-function"><span class="token function">getNamesExactly</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> HasNames<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>arg<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token string">'names'</span><span class="token punctuation">]</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> arg<span class="token punctuation">.</span>names<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// Inferred type: string[]</span>
<span class="token keyword">const</span> names <span class="token operator">=</span> <span class="token function">getNamesExactly</span><span class="token punctuation">(</span><span class="token punctuation">{</span> names<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'Alice'</span><span class="token punctuation">,</span> <span class="token string">'Bob'</span><span class="token punctuation">,</span> <span class="token string">'Eve'</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>这样做的目的通常是为了允许后面可以进行修改。</p> <p>然而，根据  <code>getNamesExactly</code>  的具体功能和预期使用方式，通常情况下需要更加具体的类型。</p> <p>直到现在，API 作者们通常不得不在一些位置上添加  <code>as const</code>  来达到预期的类型推断目的：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// The type we wanted:</span>
<span class="token comment">//    readonly [&quot;Alice&quot;, &quot;Bob&quot;, &quot;Eve&quot;]</span>
<span class="token comment">// The type we got:</span>
<span class="token comment">//    string[]</span>
<span class="token keyword">const</span> names1 <span class="token operator">=</span> <span class="token function">getNamesExactly</span><span class="token punctuation">(</span><span class="token punctuation">{</span> names<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'Alice'</span><span class="token punctuation">,</span> <span class="token string">'Bob'</span><span class="token punctuation">,</span> <span class="token string">'Eve'</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Correctly gets what we wanted:</span>
<span class="token comment">//    readonly [&quot;Alice&quot;, &quot;Bob&quot;, &quot;Eve&quot;]</span>
<span class="token keyword">const</span> names2 <span class="token operator">=</span> <span class="token function">getNamesExactly</span><span class="token punctuation">(</span><span class="token punctuation">{</span> names<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'Alice'</span><span class="token punctuation">,</span> <span class="token string">'Bob'</span><span class="token punctuation">,</span> <span class="token string">'Eve'</span><span class="token punctuation">]</span> <span class="token punctuation">}</span> <span class="token keyword">as</span> <span class="token keyword">const</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>这样做既繁琐又容易忘。
在 TypeScript 5.0 里，你可以为类型参数声明添加  <code>const</code>  修饰符，
这使得  <code>const</code>  形式的类型推断成为默认行为：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">type</span> <span class="token class-name">HasNames</span> <span class="token operator">=</span> <span class="token punctuation">{</span> names<span class="token operator">:</span> <span class="token keyword">readonly</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token generic-function"><span class="token function">getNamesExactly</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">const</span> <span class="token constant">T</span> <span class="token keyword">extends</span> HasNames<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>arg<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token string">'names'</span><span class="token punctuation">]</span> <span class="token punctuation">{</span>
  <span class="token comment">//                       ^^^^^</span>
  <span class="token keyword">return</span> arg<span class="token punctuation">.</span>names<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// Inferred type: readonly [&quot;Alice&quot;, &quot;Bob&quot;, &quot;Eve&quot;]</span>
<span class="token comment">// Note: Didn't need to write 'as const' here</span>
<span class="token keyword">const</span> names <span class="token operator">=</span> <span class="token function">getNamesExactly</span><span class="token punctuation">(</span><span class="token punctuation">{</span> names<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'Alice'</span><span class="token punctuation">,</span> <span class="token string">'Bob'</span><span class="token punctuation">,</span> <span class="token string">'Eve'</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>注意， <code>const</code>  修饰符不会<em>拒绝</em>可修改的值，并且不需要不可变约束。
使用可变类型约束可能会产生令人惊讶的结果。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token generic-function"><span class="token function">fnBad</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">const</span> <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>args<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>

<span class="token comment">// 'T' is still 'string[]' since 'readonly [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]' is not assignable to 'string[]'</span>
<span class="token function">fnBad</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>这里， <code>T</code>  的候选推断类型为  <code>readonly [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]</code> ，但是  <code>readonly</code>  只读数组不能用在需要可变数组的地方。
这种情况下，类型推断会回退到类型约束，将数组视为  <code>string[]</code>  类型，因此函数调用仍然会成功。</p> <p>这个函数更好的定义是使用  <code>readonly string[]</code> ：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token generic-function"><span class="token function">fnGood</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">const</span> <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token keyword">readonly</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>args<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>

<span class="token comment">// T is readonly [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]</span>
<span class="token function">fnGood</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>要注意  <code>const</code>  修饰符只影响在函数调用中直接写出的对象、数组和基本表达式的类型推断，
因此，那些无法（或不会）使用  <code>as const</code>  进行修饰的参数在行为上不会有任何变化：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token generic-function"><span class="token function">fnGood</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">const</span> <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token keyword">readonly</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>args<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">// 'T' is still 'string[]'-- the 'const' modifier has no effect here</span>
<span class="token function">fnGood</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>更多详情请参考 <a href="https://github.com/microsoft/TypeScript/pull/51865" target="_blank" rel="noopener noreferrer">PR<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，<a href="https://github.com/microsoft/TypeScript/issues/30680" target="_blank" rel="noopener noreferrer">PR<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 和 <a href="https://github.com/microsoft/TypeScript/issues/41114" target="_blank" rel="noopener noreferrer">PR<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <h2 id="extends-支持多个配置文件"><a href="#extends-支持多个配置文件" class="header-anchor">#</a> <code>extends</code>  支持多个配置文件</h2> <p>在管理多个项目时，拥有一个 “基础” 配置文件，其他 tsconfig.json 文件可以继承它，这会非常有帮助。
这就是为什么 TypeScript 支持使用  <code>extends</code>  字段来从  <code>compilerOptions</code>  中复制字段的原因。</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token comment">// packages/front-end/src/tsconfig.json</span>
<span class="token punctuation">{</span>
  <span class="token property">&quot;extends&quot;</span><span class="token operator">:</span> <span class="token string">&quot;../../../tsconfig.base.json&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;compilerOptions&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;outDir&quot;</span><span class="token operator">:</span> <span class="token string">&quot;../lib&quot;</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>然而，有时您可能想要从多个配置文件中进行继承。
例如，假设您正在使用一个<a href="https://github.com/tsconfig/bases" target="_blank" rel="noopener noreferrer">在 npm 上发布的 TypeScript 基础配置文件<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。
如果您希望自己所有的项目也使用 npm 上的  <code>@tsconfig/strictest</code>  包中的选项，那么有一个简单的解决方案：让  <code>tsconfig.base.json</code>  从  <code>@tsconfig/strictest</code>  进行扩展：</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token comment">// tsconfig.base.json</span>
<span class="token punctuation">{</span>
  <span class="token property">&quot;extends&quot;</span><span class="token operator">:</span> <span class="token string">&quot;@tsconfig/strictest/tsconfig.json&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;compilerOptions&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这在某种程度上是有效的。
如果您的某些工程不想使用  <code>@tsconfig/strictest</code> ，那么必须手动禁用这些选项，或者创建一个不继承于  <code>@tsconfig/strictest</code>  的  <code>tsconfig.base.json</code> 。</p> <p>为了提高灵活性，TypeScript 5.0 允许  <code>extends</code>  字段指定多个值。
例如，有如下的配置文件：</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;extends&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;b&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;c&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;compilerOptions&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这样写就如同是直接继承  <code>c</code> ，而  <code>c</code>  继承于  <code>b</code> ， <code>b</code>  继承于  <code>a</code> 。
如果出现冲突，后来者会被采纳。</p> <p>在下面的例子中，在最终的  <code>tsconfig.json</code>  中  <code>strictNullChecks</code>  和  <code>noImplicitAny</code>  会被启用。</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token comment">// tsconfig1.json</span>
<span class="token punctuation">{</span>
    <span class="token property">&quot;compilerOptions&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;strictNullChecks&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// tsconfig2.json</span>
<span class="token punctuation">{</span>
    <span class="token property">&quot;compilerOptions&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;noImplicitAny&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// tsconfig.json</span>
<span class="token punctuation">{</span>
    <span class="token property">&quot;extends&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;./tsconfig1.json&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;./tsconfig2.json&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;files&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;./index.ts&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>另一个例子，我们可以这样改写最初的示例：</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token comment">// packages/front-end/src/tsconfig.json</span>
<span class="token punctuation">{</span>
  <span class="token property">&quot;extends&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;@tsconfig/strictest/tsconfig.json&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;../../../tsconfig.base.json&quot;</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;compilerOptions&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;outDir&quot;</span><span class="token operator">:</span> <span class="token string">&quot;../lib&quot;</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>更多详情请参考：<a href="https://github.com/microsoft/TypeScript/pull/50403" target="_blank" rel="noopener noreferrer">PR<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <h2 id="所有的-enum-均为联合-enum"><a href="#所有的-enum-均为联合-enum" class="header-anchor">#</a> 所有的  <code>enum</code>  均为联合  <code>enum</code></h2> <p>在最初 TypeScript 引入枚举类型时，它们只不过是一组同类型的数值常量。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">enum</span> <span class="token constant">E</span> <span class="token punctuation">{</span>
  Foo <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span>
  Bar <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>E.Foo</code>  和  <code>E.Bar</code>  唯一特殊的地方在于它们可以赋值给任何期望类型为  <code>E</code>  的地方。
除此之外，它们基本上等同于  <code>number</code>  类型。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">takeValue</span><span class="token punctuation">(</span>e<span class="token operator">:</span> <span class="token constant">E</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token function">takeValue</span><span class="token punctuation">(</span><span class="token constant">E</span><span class="token punctuation">.</span>Foo<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// works</span>
<span class="token function">takeValue</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// error!</span>
</code></pre></div><p>直到 TypeScript 2.0 引入了枚举字面量类型，枚举才变得更为特殊。
枚举字面量类型为每个枚举成员提供了其自己的类型，并将枚举本身转换为每个成员类型的联合类型。
它们还允许我们仅引用枚举中的一部分类型，并细化掉那些类型。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// Color is like a union of Red | Orange | Yellow | Green | Blue | Violet</span>
<span class="token keyword">enum</span> Color <span class="token punctuation">{</span>
    Red<span class="token punctuation">,</span> Orange<span class="token punctuation">,</span> Yellow<span class="token punctuation">,</span> Green<span class="token punctuation">,</span> Blue<span class="token punctuation">,</span> <span class="token comment">/* Indigo */</span><span class="token punctuation">,</span> Violet
<span class="token punctuation">}</span>

<span class="token comment">// Each enum member has its own type that we can refer to!</span>
<span class="token keyword">type</span> <span class="token class-name">PrimaryColor</span> <span class="token operator">=</span> Color<span class="token punctuation">.</span>Red <span class="token operator">|</span> Color<span class="token punctuation">.</span>Green <span class="token operator">|</span> Color<span class="token punctuation">.</span>Blue<span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">isPrimaryColor</span><span class="token punctuation">(</span>c<span class="token operator">:</span> Color<span class="token punctuation">)</span><span class="token operator">:</span> c <span class="token keyword">is</span> PrimaryColor <span class="token punctuation">{</span>
    <span class="token comment">// Narrowing literal types can catch bugs.</span>
    <span class="token comment">// TypeScript will error here because</span>
    <span class="token comment">// we'll end up comparing 'Color.Red' to 'Color.Green'.</span>
    <span class="token comment">// We meant to use ||, but accidentally wrote &amp;&amp;.</span>
    <span class="token keyword">return</span> c <span class="token operator">===</span> Color<span class="token punctuation">.</span>Red <span class="token operator">&amp;&amp;</span> c <span class="token operator">===</span> Color<span class="token punctuation">.</span>Green <span class="token operator">&amp;&amp;</span> c <span class="token operator">===</span> Color<span class="token punctuation">.</span>Blue<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>为每个枚举成员提供其自己的类型的一个问题是，这些类型在某种程度上与成员的实际值相关联。
在某些情况下，无法计算该值 - 例如，枚举成员可能由函数调用初始化。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">enum</span> <span class="token constant">E</span> <span class="token punctuation">{</span>
  Blah <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p>每当 TypeScript 遇到这些问题时，它会悄悄地退而使用旧的枚举策略。
这意味着放弃所有联合类型和字面量类型的优势。</p> <p>TypeScript 5.0 通过为每个计算成员创建唯一类型，成功将所有枚举转换为联合枚举。
这意味着现在所有枚举都可以被细化，并且每个枚举成员都有其自己的类型。</p> <p>更多详情请参考 <a href="https://github.com/microsoft/TypeScript/pull/50528" target="_blank" rel="noopener noreferrer">PR<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="moduleresolution-bundler"><a href="#moduleresolution-bundler" class="header-anchor">#</a> <code>--moduleResolution bundler</code></h2> <p>TypeScript 4.7 支持将  <code>--module</code>  和  <code>--moduleResolution</code>  选项设置为  <code>node16</code>  和  <code>nodenext</code> 。
这些选项的目的是更好地模拟  <code>Node.js</code>  中 ECMAScript 模块的精确查找规则；
然而，这种模式存在许多其他工具实际上并不强制执行的限制。</p> <p>例如，在 Node.js 的 ECMAScript 模块中，任何相对导入都需要包含文件扩展名。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// entry.mjs</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> utils <span class="token keyword">from</span> <span class="token string">'./utils'</span><span class="token punctuation">;</span> <span class="token comment">//  wrong - we need to include the file extension.</span>

<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> utils <span class="token keyword">from</span> <span class="token string">'./utils.mjs'</span><span class="token punctuation">;</span> <span class="token comment">//  works</span>
</code></pre></div><p>对于 Node.js 和浏览器来说，这样做有一些原因 - 它可以加快文件查找速度，并且对于简单的文件服务器效果更好。
但是对于许多使用打包工具的开发人员来说， <code>node16</code>  /  <code>nodenext</code>  设置很麻烦，
因为打包工具中没有这么多限制。
在某些方面， <code>node</code>  解析模式对于任何使用打包工具的人来说是更好的。</p> <p>但在某些方面，原始的  <code>node</code>  解析模式已经过时了。
大多数现代打包工具在 Node.js 中使用 ECMAScript 模块和 CommonJS 查找规则的融合。
例如，像在 CommonJS 中一样，无扩展名的导入也可以正常工作，但是在查找<a href="https://nodejs.org/api/packages.html#nested-conditions" target="_blank" rel="noopener noreferrer">包的导出条件<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>时，它们将首选像在 ECMAScript 文件中一样的  <code>import</code>  条件。</p> <p>为了模拟打包工具的工作方式，TypeScript 现在引入了一种新策略： <code>--moduleResolution bundler</code> 。</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;compilerOptions&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;target&quot;</span><span class="token operator">:</span> <span class="token string">&quot;esnext&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;moduleResolution&quot;</span><span class="token operator">:</span> <span class="token string">&quot;bundler&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>如果你使用如 Vite， esbuild, swc, Webpack, parcel 等现代打包工具，它们实现了混合的查找策略，新的  <code>bundler</code>  选项是更好的选择。</p> <p>另一方面，如果您正在编写一个要发布到 npm 的代码库，那么使用  <code>bundler</code>  选项可能会隐藏影响未使用打包工具用户的兼容性问题。
因此，在这些情况下，使用  <code>node16</code>  或  <code>nodenext</code>  解析选项可能是更好的选择。</p> <p>更多详情请参考 <a href="https://github.com/microsoft/TypeScript/pull/51669" target="_blank" rel="noopener noreferrer">PR<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="定制化解析的标记"><a href="#定制化解析的标记" class="header-anchor">#</a> 定制化解析的标记</h2> <p>JavaScript 工具现在可以模拟 “混合” 解析规则，就像我们上面描述的  <code>bundler</code>  模式一样。
由于工具的支持可能有所不同，因此 TypeScript 5.0 提供了启用或禁用一些功能的方法，这些功能可能无法与您的配置一起使用。</p> <h3 id="allowimportingtsextensions"><a href="#allowimportingtsextensions" class="header-anchor">#</a> <code>allowImportingTsExtensions</code></h3> <p><code>--allowImportingTsExtensions</code>  允许 TypeScript 文件导入使用了 TypeScript 特定扩展名的文件，例如  <code>.ts</code> ,  <code>.mts</code> ,  <code>.tsx</code> 。</p> <p>此标记仅在启用了  <code>--noEmit</code>  或  <code>--emitDeclarationOnly</code>  时允许使用，
因为这些导入路径无法在运行时的 JavaScript 输出文件中被解析。
这里的期望是，您的解析器（例如打包工具、运行时或其他工具）将保证这些在  <code>.ts</code>  文件之间的导入可以工作。</p> <h3 id="resolvepackagejsonexports"><a href="#resolvepackagejsonexports" class="header-anchor">#</a> resolvePackageJsonExports</h3> <p><code>--resolvePackageJsonExports</code>  强制 TypeScript 使用 <a href="https://nodejs.org/api/packages.html#exports" target="_blank" rel="noopener noreferrer">package.json 里的 exports 字段<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，如果它尝试读取  <code>node_modules</code>  里的某个包。</p> <p>当  <code>--moduleResolution</code>  为  <code>node16</code> ,  <code>nodenext</code>  和  <code>bundler</code>  时，该选项的默认值为  <code>true</code> 。</p> <h3 id="resolvepackagejsonimports"><a href="#resolvepackagejsonimports" class="header-anchor">#</a> <code>resolvePackageJsonImports</code></h3> <p><code>--resolvePackageJsonImports</code>  强制 TypeScript 使用 <a href="https://nodejs.org/api/packages.html#imports" target="_blank" rel="noopener noreferrer">package.json 里的 imports 字段<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，当它查找以  <code>#</code>  开头的文件时，且该文件的父目录中包含  <code>package.json</code>  文件。</p> <p>当  <code>--moduleResolution</code>  为  <code>node16</code> ,  <code>nodenext</code>  和  <code>bundler</code>  时，该选项的默认值为  <code>true</code> 。</p> <h3 id="allowarbitraryextensions"><a href="#allowarbitraryextensions" class="header-anchor">#</a> <code>allowArbitraryExtensions</code></h3> <p>在 TypeScript 5.0 中，当导入路径不是以已知的 JavaScript 或 TypeScript 文件扩展名结尾时，编译器将查找该路径的声明文件，形式为  <code>{文件基础名称}.d.{扩展名}.ts</code> 。
例如，如果您在打包项目中使用 CSS 加载器，您可能需要编写（或生成）如下的声明文件：</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token comment">/* app.css */</span>
<span class="token selector">.cookie-banner</span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// app.d.css.ts</span>
<span class="token keyword">declare</span> <span class="token keyword">const</span> css<span class="token operator">:</span> <span class="token punctuation">{</span>
  cookieBanner<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> css<span class="token punctuation">;</span>
</code></pre></div><div class="language-tsx extra-class"><pre class="language-tsx"><code><span class="token comment">// App.tsx</span>
<span class="token keyword">import</span> styles <span class="token keyword">from</span> <span class="token string">'./app.css'</span><span class="token punctuation">;</span>

styles<span class="token punctuation">.</span>cookieBanner<span class="token punctuation">;</span> <span class="token comment">// string</span>
</code></pre></div><p>默认情况下，该导入将引发错误，告诉您 TypeScript 不支持此文件类型，您的运行时可能不支持导入它。
但是，如果您已经配置了运行时或打包工具来处理它，您可以使用新的  <code>--allowArbitraryExtensions</code>  编译器选项来抑制错误。</p> <p>需要注意的是，历史上通常可以通过添加名为  <code>app.css.d.ts</code>  而不是  <code>app.d.css.ts</code>  的声明文件来实现类似的效果 - 但是，这只在 Node.js 中 CommonJS 的  <code>require</code>  解析规则下可以工作。
严格来说，前者被解析为名为  <code>app.css.js</code>  的 JavaScript 文件的声明文件。
由于 Node 中的 ESM 需要使用包含扩展名的相对文件导入，因此在  <code>--moduleResolution</code>  为  <code>node16</code>  或  <code>nodenext</code>  时，TypeScript 会在示例的 ESM 文件中报错。</p> <p>更多详情请参考 <a href="https://github.com/microsoft/TypeScript/issues/50133" target="_blank" rel="noopener noreferrer">PR<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="https://github.com/microsoft/TypeScript/pull/51435" target="_blank" rel="noopener noreferrer">PR<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <h3 id="customconditions"><a href="#customconditions" class="header-anchor">#</a> <code>customConditions</code></h3> <p><code>--customConditions</code>  接受额外的<a href="https://nodejs.org/api/packages.html#nested-conditions" target="_blank" rel="noopener noreferrer">条件<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>列表，当 TypeScript 从 package.json 的<a href="https://nodejs.org/api/packages.html#exports" target="_blank" rel="noopener noreferrer"> exports<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 或 <a href="https://nodejs.org/api/packages.html#imports" target="_blank" rel="noopener noreferrer">imports<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 字段解析时，这些条件应该成功。
这些条件会被添加到解析器默认使用的任何现有条件中。</p> <p>例如，有如下的配置：</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;compilerOptions&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;target&quot;</span><span class="token operator">:</span> <span class="token string">&quot;es2022&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;moduleResolution&quot;</span><span class="token operator">:</span> <span class="token string">&quot;bundler&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;customConditions&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;my-condition&quot;</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>每当  <code>package.json</code>  里引用了  <code>exports</code>  或  <code>imports</code>  字段时，TypeScript 都会考虑名为  <code>my-condition</code>  的条件。</p> <p>所以当从具有如下  <code>package.json</code>  的包中导入时：</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  <span class="token property">&quot;exports&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;.&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;my-condition&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./foo.mjs&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;node&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./bar.mjs&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;import&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./baz.mjs&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;require&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./biz.mjs&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>TypeScript 会尝试查找  <code>foo.mjs</code>  文件。</p> <p>该字段仅在  <code>--moduleResolution</code>  为  <code>node16</code> ,  <code>nodenext</code>  和  <code>bundler</code>  时有效。</p> <h2 id="verbatimmodulesyntax"><a href="#verbatimmodulesyntax" class="header-anchor">#</a> --verbatimModuleSyntax</h2> <p>在默认情况下，TypeScript 会执行<em>导入省略</em>。
大体上来讲，如果有如下代码：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Car <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./car'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">drive</span><span class="token punctuation">(</span>car<span class="token operator">:</span> Car<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre></div><p>TypeScript 能够检测到导入语句仅用于导入类型，因此会删除导入语句。
最终生成的 JavaScript 代码如下：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">drive</span><span class="token punctuation">(</span><span class="token parameter">car</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre></div><p>大多数情况下这是没问题的，因为如果  <code>Car</code>  不是从  <code>./car</code>  导出的值，我们将会得到一个运行时错误。</p> <p>但在一些特殊情况下，它增加了一层复杂性。
例如，不存在像  <code>import &quot;./car&quot;;</code>  这样的语句 - 这个导入语句会被完全删除。
这对于有副作用的模块来讲是有区别的。</p> <p>TypeScript 的 JavaScript 代码生成策略还有其它一些复杂性 - 导入省略不仅只是由导入语句的使用方式决定 - 它还取决于值的声明方式。
因此，如下的代码的处理方式不总是那么明显：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">export</span> <span class="token punctuation">{</span> Car <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./car'</span><span class="token punctuation">;</span>
</code></pre></div><p>这段代码是应该保留还是删除？
如果  <code>Car</code>  是使用  <code>class</code>  声明的，那么在生成的 JavaScript 代码中会被保留。
但是如果  <code>Car</code>  是使用类型别名或  <code>interface</code>  声明的，那么在生成的 JavaScript 代码中会被省略。</p> <p>尽管 TypeScript 可以根据多个文件来综合判断如何生成代码，但不是所有的编译器都能够做到。</p> <p>导入和导出语句中的  <code>type</code>  修饰符能够起到一点作用。
我们可以使用  <code>type</code>  修饰符明确声明导入和导出是否仅用于类型分析，并且可以在生成的 JavaScript 文件中完全删除。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// This statement can be dropped entirely in JS output</span>
<span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token operator">*</span> <span class="token keyword">as</span> car <span class="token keyword">from</span> <span class="token string">'./car'</span><span class="token punctuation">;</span>

<span class="token comment">// The named import/export 'Car' can be dropped in JS output</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token keyword">type</span> <span class="token class-name">Car</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./car'</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span> <span class="token keyword">type</span> <span class="token class-name">Car</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./car'</span><span class="token punctuation">;</span>
</code></pre></div><p><code>type</code>  修饰符本身并不是特别管用 - 默认情况下，导入省略仍会删除导入语句，
并且不强制要求您区分类型导入和普通导入以及导出。
因此，TypeScript 提供了  <code>--importsNotUsedAsValues</code>  来确保您使用类型修饰符，
 <code>--preserveValueImports</code>  来防止<em>某些</em>模块消除行为，
以及  <code>--isolatedModules</code>  来确保您的 TypeScript 代码在不同编译器中都能正常运行。
不幸的是，理解这三个标志的细节很困难，并且仍然存在一些意外行为的边缘情况。</p> <p>TypeScript 5.0 提供了一个新的  <code>--verbatimModuleSyntax</code>  来简化这个情况。
规则很简单 - 所有不带  <code>type</code>  修饰符的导入导出语句会被保留。
任何带有  <code>type</code>  修饰符的导入导出语句会被删除。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// Erased away entirely.</span>
<span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span> <span class="token constant">A</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'a'</span><span class="token punctuation">;</span>

<span class="token comment">// Rewritten to 'import { b } from &quot;bcd&quot;;'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> b<span class="token punctuation">,</span> <span class="token keyword">type</span> <span class="token class-name">c</span><span class="token punctuation">,</span> <span class="token keyword">type</span> <span class="token class-name">d</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'bcd'</span><span class="token punctuation">;</span>

<span class="token comment">// Rewritten to 'import {} from &quot;xyz&quot;;'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token keyword">type</span> <span class="token class-name">xyz</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'xyz'</span><span class="token punctuation">;</span>
</code></pre></div><p>使用这个新的选项，实现了所见即所得。</p> <p>但是，这在涉及模块互操作性时会有一些影响。
在这个标志下，当您的设置或文件扩展名暗示了不同的模块系统时，ECMAScript 的导入和导出不会被重写为  <code>require</code>  调用。
相反，您会收到一个错误。
如果您需要生成使用  <code>require</code>  和  <code>module.exports</code>  的代码，您需要使用早于 ES2015 的 TypeScript 的模块语法：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> foo <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ==&gt;</span>

<span class="token keyword">const</span> foo <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">baz</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  foo<span class="token punctuation">,</span>
  bar<span class="token punctuation">,</span>
  baz<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// ==&gt;</span>

<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">baz</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  foo<span class="token punctuation">,</span>
  bar<span class="token punctuation">,</span>
  baz<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>虽然这是一种限制，但它确实有助于使一些问题更加明显。
例如，在  <code>--module node16</code>  下很容易忘记<a href="https://nodejs.org/api/packages.html#type" target="_blank" rel="noopener noreferrer">在 package.json 中设置  <code>type</code>  字段<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。
结果是开发人员会开始编写 CommonJS 模块而不是 ES 模块，但却没有意识到这一点，从而导致查找规则和 JavaScript 输出出现意外的结果。
这个新的标志确保您有意识地使用文件类型，因为语法是刻意不同的。</p> <p>因为  <code>--verbatimModuleSyntax</code>  相比于  <code>--importsNotUsedAsValues</code>  和  <code>--preserveValueImports</code>  提供了更加一致的行为，推荐使用前者，后两个标记将被弃用。</p> <p>更多详情请参考 <a href="https://github.com/microsoft/TypeScript/pull/52203" target="_blank" rel="noopener noreferrer">PR<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 和 <a href="https://github.com/microsoft/TypeScript/issues/51479" target="_blank" rel="noopener noreferrer">issue<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <h2 id="支持-export-type"><a href="#支持-export-type" class="header-anchor">#</a> 支持  <code>export type *</code></h2> <p>在 TypeScript 3.8 引入类型导入时，该语法不支持在  <code>export * from &quot;module&quot;</code>  或  <code>export * as ns from &quot;module&quot;</code>  重新导出上使用。
TypeScript 5.0 添加了对两者的支持：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// models/vehicles.ts</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Spaceship</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>

<span class="token comment">// models/index.ts</span>
<span class="token keyword">export</span> <span class="token keyword">type</span> <span class="token operator">*</span> <span class="token keyword">as</span> vehicles <span class="token keyword">from</span> <span class="token string">'./vehicles'</span><span class="token punctuation">;</span>

<span class="token comment">// main.ts</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> vehicles <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./models'</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">takeASpaceship</span><span class="token punctuation">(</span>s<span class="token operator">:</span> vehicles<span class="token punctuation">.</span>Spaceship<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//  ok - `vehicles` only used in a type position</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">makeASpaceship</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">vehicles</span><span class="token punctuation">.</span><span class="token function">Spaceship</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//         ^^^^^^^^</span>
  <span class="token comment">// 'vehicles' cannot be used as a value because it was exported using 'export type'.</span>
<span class="token punctuation">}</span>
</code></pre></div><p>更多详情请参考 <a href="https://github.com/microsoft/TypeScript/pull/52217" target="_blank" rel="noopener noreferrer">PR<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <h2 id="支持-jsdoc-中的-satisfies"><a href="#支持-jsdoc-中的-satisfies" class="header-anchor">#</a> 支持 JSDoc 中的  <code>@satisfies</code></h2> <p>TypeScript 4.9 支持  <code>satisfies</code>  运算符。
它确保了表达式的类型是兼容的，且不影响类型自身。
例如，有如下代码：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">interface</span> <span class="token class-name">CompilerOptions</span> <span class="token punctuation">{</span>
  strict<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
  outDir<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>

<span class="token keyword">interface</span> <span class="token class-name">ConfigSettings</span> <span class="token punctuation">{</span>
  compilerOptions<span class="token operator">?</span><span class="token operator">:</span> CompilerOptions<span class="token punctuation">;</span>
  <span class="token keyword">extends</span><span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> myConfigSettings <span class="token operator">=</span> <span class="token punctuation">{</span>
  compilerOptions<span class="token operator">:</span> <span class="token punctuation">{</span>
    strict<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    outDir<span class="token operator">:</span> <span class="token string">'../lib'</span><span class="token punctuation">,</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token keyword">extends</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'@tsconfig/strictest/tsconfig.json'</span><span class="token punctuation">,</span> <span class="token string">'../../../tsconfig.base.json'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span> satisfies ConfigSettings<span class="token punctuation">;</span>
</code></pre></div><p>这里，TypeScript 知道  <code>myConfigSettings.extends</code>  声明为数组 - 因为  <code>satisfies</code>  会验证对象的类型。
因此，如果我们想在  <code>extends</code>  上进行映射操作，那是可以的。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token function">resolveConfig</span><span class="token punctuation">(</span>configPath<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> CompilerOptions<span class="token punctuation">;</span>

<span class="token keyword">let</span> inheritedConfigs <span class="token operator">=</span> myConfigSettings<span class="token punctuation">.</span>extends<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>resolveConfig<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>这对 TypeScript 用户来讲是有用处的，但是许多人使用 TypeScript 来对带有 JSDoc 的 JavaScript 代码进行类型检查。
因此，TypeScript 5.0 支持了新的 JSDoc 标签  <code>@satisfies</code>  来做相同的事。</p> <p><code>/** @satisfies */</code>  能够检查出类型不匹配：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// @ts-check</span>

<span class="token comment">/**
 * @typedef CompilerOptions
 * @prop {boolean} [strict]
 * @prop {string} [outDir]
 */</span>

<span class="token comment">/**
 * @satisfies {CompilerOptions}
 */</span>
<span class="token keyword">let</span> myCompilerOptions <span class="token operator">=</span> <span class="token punctuation">{</span>
  outdir<span class="token operator">:</span> <span class="token string">'../lib'</span><span class="token punctuation">,</span>
  <span class="token comment">//  ~~~~~~ oops! we meant outDir</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>但它会保留表达式的原始类型，允许我们稍后使用值的更详细的类型。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// @ts-check</span>

<span class="token comment">/**
 * @typedef CompilerOptions
 * @prop {boolean} [strict]
 * @prop {string} [outDir]
 */</span>

<span class="token comment">/**
 * @typedef ConfigSettings
 * @prop {CompilerOptions} [compilerOptions]
 * @prop {string | string[]} [extends]
 */</span>

<span class="token comment">/**
 * @satisfies {ConfigSettings}
 */</span>
<span class="token keyword">let</span> myConfigSettings <span class="token operator">=</span> <span class="token punctuation">{</span>
  compilerOptions<span class="token operator">:</span> <span class="token punctuation">{</span>
    strict<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    outDir<span class="token operator">:</span> <span class="token string">'../lib'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token keyword">extends</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'@tsconfig/strictest/tsconfig.json'</span><span class="token punctuation">,</span> <span class="token string">'../../../tsconfig.base.json'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> inheritedConfigs <span class="token operator">=</span> myConfigSettings<span class="token punctuation">.</span>extends<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>resolveConfig<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>/** @satisfies */</code>  也可以在行内的括号表达式上使用。
可以像下面这样定义  <code>myConfigSettings</code> ：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">let</span> myConfigSettings <span class="token operator">=</span> <span class="token comment">/** @satisfies {ConfigSettings} */</span> <span class="token punctuation">{</span>
  compilerOptions<span class="token operator">:</span> <span class="token punctuation">{</span>
    strict<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    outDir<span class="token operator">:</span> <span class="token string">'../lib'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token keyword">extends</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'@tsconfig/strictest/tsconfig.json'</span><span class="token punctuation">,</span> <span class="token string">'../../../tsconfig.base.json'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>为什么？当你更深入地研究其他代码时，比如函数调用，它通常更有意义。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token function">compileCode</span><span class="token punctuation">(</span>
  <span class="token comment">/** @satisfies {ConfigSettings} */</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>更多详情请参考 <a href="https://github.com/microsoft/TypeScript/pull/51753" target="_blank" rel="noopener noreferrer">PR<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。
感谢作者 <a href="https://github.com/a-tarasyuk" target="_blank" rel="noopener noreferrer">Oleksandr Tarasiuk<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <h2 id="支持-jsdoc-中的-overload"><a href="#支持-jsdoc-中的-overload" class="header-anchor">#</a> 支持 JSDoc 中的  <code>@overload</code></h2> <p>在 TypeScript 中，你可以为一个函数指定多个重载。
使用重载能够描述一个函数可以使用不同的参数进行调用，也可能会返回不同的结果。
它们可以限制调用方如何调用函数，并细化他们将得到的结果。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// Our overloads:</span>
<span class="token keyword">function</span> <span class="token function">printValue</span><span class="token punctuation">(</span>str<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">printValue</span><span class="token punctuation">(</span>num<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> maxFractionDigits<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>

<span class="token comment">// Our implementation:</span>
<span class="token keyword">function</span> <span class="token function">printValue</span><span class="token punctuation">(</span>value<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">number</span><span class="token punctuation">,</span> maximumFractionDigits<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> value <span class="token operator">===</span> <span class="token string">'number'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> formatter <span class="token operator">=</span> Intl<span class="token punctuation">.</span><span class="token function">NumberFormat</span><span class="token punctuation">(</span><span class="token string">'en-US'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      maximumFractionDigits<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    value <span class="token operator">=</span> formatter<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这里表示  <code>printValue</code>  的第一个参数可以为  <code>string</code>  或  <code>number</code>  类型。
如果接收的是  <code>number</code>  类型，那么它还接收第二个参数决定打印的小数位数。</p> <p>TypeScript 5.0 支持在 JSDoc 里使用  <code>@overload</code>  来声明重载。
每一个 JSDoc  <code>@overload</code>  标记都表示一个不同的函数重载。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// @ts-check</span>

<span class="token comment">/**
 * @overload
 * @param {string} value
 * @return {void}
 */</span>

<span class="token comment">/**
 * @overload
 * @param {number} value
 * @param {number} [maximumFractionDigits]
 * @return {void}
 */</span>

<span class="token comment">/**
 * @param {string | number} value
 * @param {number} [maximumFractionDigits]
 */</span>
<span class="token keyword">function</span> <span class="token function">printValue</span><span class="token punctuation">(</span><span class="token parameter">value<span class="token punctuation">,</span> maximumFractionDigits</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> value <span class="token operator">===</span> <span class="token string">'number'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> formatter <span class="token operator">=</span> Intl<span class="token punctuation">.</span><span class="token function">NumberFormat</span><span class="token punctuation">(</span><span class="token string">'en-US'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      maximumFractionDigits<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    value <span class="token operator">=</span> formatter<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>现在不论是编写 TypeScript 文件还是 JavaScript 文件，TypeScript 都能够提示函数调用是否正确。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// all allowed</span>
<span class="token function">printValue</span><span class="token punctuation">(</span><span class="token string">'hello!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">printValue</span><span class="token punctuation">(</span><span class="token number">123.45</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">printValue</span><span class="token punctuation">(</span><span class="token number">123.45</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">printValue</span><span class="token punctuation">(</span><span class="token string">'hello!'</span><span class="token punctuation">,</span> <span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// error!</span>
</code></pre></div><p>更多详情请参考 <a href="https://github.com/microsoft/TypeScript/pull/51234" target="_blank" rel="noopener noreferrer">PR<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，感谢 <a href="https://github.com/apendua" target="_blank" rel="noopener noreferrer">Tomasz Lenarcik<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <h2 id="在-build-模式下使用有关文件生成的选项"><a href="#在-build-模式下使用有关文件生成的选项" class="header-anchor">#</a> 在  <code>--build</code>  模式下使用有关文件生成的选项</h2> <p>TypeScript 现在允许在  <code>--build</code>  模式下使用如下选项：</p> <ul><li><code>--declaration</code></li> <li><code>--emitDeclarationOnly</code></li> <li><code>--declarationMap</code></li> <li><code>--sourceMap</code></li> <li><code>--inlineSourceMap</code></li></ul> <p>这使得在构建过程中定制某些部分变得更加容易，特别是在你可能会有不同的开发和生产构建时。</p> <p>例如，一个库的开发构建可能不需要生成声明文件，但是生产构建则需要。
一个项目可以将生成声明文件配置为默认关闭，并使用如下方式构建：</p> <div class="language-sh extra-class"><pre class="language-sh"><code>tsc <span class="token parameter variable">--build</span> <span class="token parameter variable">-p</span> ./my-project-dir
</code></pre></div><p>开发完毕后，在 “生产环境” 构建时使用  <code>--declaration</code>  选项：</p> <div class="language-sh extra-class"><pre class="language-sh"><code>tsc <span class="token parameter variable">--build</span> <span class="token parameter variable">-p</span> ./my-project-dir <span class="token parameter variable">--declaration</span>
</code></pre></div><p>更多详情请参考 <a href="https://github.com/microsoft/TypeScript/pull/51241" target="_blank" rel="noopener noreferrer">PR<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <h2 id="编辑器导入语句排序时不区分大小写"><a href="#编辑器导入语句排序时不区分大小写" class="header-anchor">#</a> 编辑器导入语句排序时不区分大小写</h2> <p>在 Visual Studio 和 VS Code 等编辑器中，TypeScript 可以帮助组织和排序导入和导出语句。
不过，通常情况下，对于何时将列表 “排序”，可能会有不同的解释。</p> <p>例如，下面的导入列表是否已排序？</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Toggle<span class="token punctuation">,</span> freeze<span class="token punctuation">,</span> toBoolean <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./utils'</span><span class="token punctuation">;</span>
</code></pre></div><p>令人惊讶的是，答案可能是 “这要看情况”。
如果我们不考虑大小写敏感性，那么这个列表显然是没有排序的。
字母 <code>f</code>  排在 <code>t</code>  和 <code>T</code>  之前。</p> <p>但在大多数编程语言中，排序默认是比较字符串的字节值。
JavaScript 比较字符串的方式意味着 “Toggle” 总是排在 “freeze” 之前，因为根据 <a href="https://en.wikipedia.org/wiki/ASCII" target="_blank" rel="noopener noreferrer">ASCII 字符编码<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，大写字母排在小写字母之前。
所以从这个角度来看，导入列表是已排序的。</p> <p>以前，TypeScript 认为导入列表已排序，因为它进行了基本的大小写敏感排序。
这可能让开发人员感到沮丧，因为他们更喜欢不区分大小写的排序方式，或者使用像 ESLint 这样的工具默认需要不区分大小写的排序方式。</p> <p>现在，TypeScript 默认会检测大小写敏感性。
这意味着 TypeScript 和类似 ESLint 的工具通常不会因为如何最好地排序导入而 “互相冲突”。</p> <p>我们的团队还在尝试更多的排序策略，你可以在<a href="https://github.com/microsoft/TypeScript/pull/52115" target="_blank" rel="noopener noreferrer">这里了解更多<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。
这些选项可能最终可以由编辑器进行配置。
目前，它们仍然不稳定和实验性的，你可以通过在 JSON 选项中使用 typescript.unstable 条目来选择它们。
下面是你可以尝试的所有选项（设置为它们的默认值）：</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;typescript.unstable&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// Should sorting be case-sensitive? Can be:</span>
    <span class="token comment">// - true</span>
    <span class="token comment">// - false</span>
    <span class="token comment">// - &quot;auto&quot; (auto-detect)</span>
    <span class="token property">&quot;organizeImportsIgnoreCase&quot;</span><span class="token operator">:</span> <span class="token string">&quot;auto&quot;</span><span class="token punctuation">,</span>

    <span class="token comment">// Should sorting be &quot;ordinal&quot; and use code points or consider Unicode rules? Can be:</span>
    <span class="token comment">// - &quot;ordinal&quot;</span>
    <span class="token comment">// - &quot;unicode&quot;</span>
    <span class="token property">&quot;organizeImportsCollation&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ordinal&quot;</span><span class="token punctuation">,</span>

    <span class="token comment">// Under `&quot;organizeImportsCollation&quot;: &quot;unicode&quot;`,</span>
    <span class="token comment">// what is the current locale? Can be:</span>
    <span class="token comment">// - [any other locale code]</span>
    <span class="token comment">// - &quot;auto&quot; (use the editor's locale)</span>
    <span class="token property">&quot;organizeImportsLocale&quot;</span><span class="token operator">:</span> <span class="token string">&quot;en&quot;</span><span class="token punctuation">,</span>

    <span class="token comment">// Under `&quot;organizeImportsCollation&quot;: &quot;unicode&quot;`,</span>
    <span class="token comment">// should upper-case letters or lower-case letters come first? Can be:</span>
    <span class="token comment">// - false (locale-specific)</span>
    <span class="token comment">// - &quot;upper&quot;</span>
    <span class="token comment">// - &quot;lower&quot;</span>
    <span class="token property">&quot;organizeImportsCaseFirst&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>

    <span class="token comment">// Under `&quot;organizeImportsCollation&quot;: &quot;unicode&quot;`,</span>
    <span class="token comment">// do runs of numbers get compared numerically (i.e. &quot;a1&quot; &lt; &quot;a2&quot; &lt; &quot;a100&quot;)? Can be:</span>
    <span class="token comment">// - true</span>
    <span class="token comment">// - false</span>
    <span class="token property">&quot;organizeImportsNumericCollation&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>

    <span class="token comment">// Under `&quot;organizeImportsCollation&quot;: &quot;unicode&quot;`,</span>
    <span class="token comment">// do letters with accent marks/diacritics get sorted distinctly</span>
    <span class="token comment">// from their &quot;base&quot; letter (i.e. is é different from e)? Can be</span>
    <span class="token comment">// - true</span>
    <span class="token comment">// - false</span>
    <span class="token property">&quot;organizeImportsAccentCollation&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;javascript.unstable&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// same options valid here...</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>更多详情请参考 <a href="https://github.com/microsoft/TypeScript/pull/51733" target="_blank" rel="noopener noreferrer">PR<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 和 <a href="https://github.com/microsoft/TypeScript/pull/52115" target="_blank" rel="noopener noreferrer">PR<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <h2 id="穷举式-switch-case-自动补全"><a href="#穷举式-switch-case-自动补全" class="header-anchor">#</a> 穷举式  <code>switch/case</code>  自动补全</h2> <p>在编写  <code>switch</code>  语句时，TypeScript 现在会检测被检查的值是否具有字面量类型。
如果是，它将提供一个补全选项，可以为每个未覆盖的情况构建骨架代码。</p> <p>更多详情请参考 <a href="https://github.com/microsoft/TypeScript/pull/50996" target="_blank" rel="noopener noreferrer">PR<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <h2 id="速度-内存以及代码包尺寸优化"><a href="#速度-内存以及代码包尺寸优化" class="header-anchor">#</a> 速度，内存以及代码包尺寸优化</h2> <p>TypeScript 5.0 在我们的代码结构、数据结构和算法实现方面进行了许多强大的变化。
这些变化的意义在于，整个体验都应该更快 —— 不仅仅是运行 TypeScript，甚至包括安装 TypeScript。</p> <p>以下是我们相对于 TypeScript 4.9 能够获得的一些有趣的速度和大小优势。</p> <table><thead><tr><th>Scenario</th> <th>Time or Size Relative to TS 4.9</th></tr></thead> <tbody><tr><td>material-ui build time</td> <td>90%</td></tr> <tr><td>TypeScript Compiler startup time</td> <td>89%</td></tr> <tr><td>Playwright build time</td> <td>88%</td></tr> <tr><td>TypeScript Compiler self-build time</td> <td>87%</td></tr> <tr><td>Outlook Web build time</td> <td>82%</td></tr> <tr><td>VS Code build time</td> <td>80%</td></tr> <tr><td>typescript npm Package Size</td> <td>59%</td></tr></tbody></table> <p><img src="https://devblogs.microsoft.com/typescript/wp-content/uploads/sites/11/2023/03/speed-5.0-stable-2.png" alt="img"></p> <p><img src="https://devblogs.microsoft.com/typescript/wp-content/uploads/sites/11/2023/03/size-5.0-stable-1.png" alt="img"></p> <p>怎么做到的呢？我们将在未来的博客文章中详细介绍一些值得注意的改进。
但我们不会让你等到那篇博客文章。</p> <p>首先，我们最近将 TypeScript 从命名空间迁移到了模块，这使我们能够利用现代构建工具来执行像作用域提升这样的优化。
使用这些工具，重新审视我们的打包策略，并删除一些已过时的代码，使 TypeScript 4.9 的 63.8 MB 包大小减少了约 26.4 MB。
这也通过直接函数调用为我们带来了显著的加速。
我们在这里撰写了关于我们迁移到模块的<a href="https://devblogs.microsoft.com/typescript/typescripts-migration-to-modules/" target="_blank" rel="noopener noreferrer">详细介绍<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <p>TypeScript 还在编译器内部对象类型上增加了更多的一致性，并且也减少了一些这些对象类型上存储的数据。
这减少了多态操作，同时平衡了由于使我们的对象结构更加一致而带来的内存使用增加。</p> <p>我们还在将信息序列化为字符串时执行了一些缓存。
类型显示，它可能在错误报告、声明生成、代码补全等情况下使用，是非常昂贵的操作。
TypeScript 现在对一些常用的机制进行缓存，以便在这些操作之间重复使用。</p> <p>我们进行了一个值得注意的改变，改善了我们的解析器，即在某些情况下，利用 var 来避免在闭包中使用 let 和 const 的成本。
这提高了一些解析性能。</p> <p>总的来说，我们预计大多数代码库应该会从 TypeScript 5.0 中看到速度的提升，并且一直能够保持 10% 到 20% 之间的优势。
当然，这将取决于硬件和代码库的特性，但我们鼓励你今天就在你的代码库上尝试它！</p> <p>更多详情：</p> <ul><li><a href="https://github.com/microsoft/TypeScript/pull/51387" target="_blank" rel="noopener noreferrer">Migrate to Modules<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://github.com/microsoft/TypeScript/pull/51682" target="_blank" rel="noopener noreferrer">Node Monomorphization<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://github.com/microsoft/TypeScript/pull/51880" target="_blank" rel="noopener noreferrer">Symbol Monomorphization<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://github.com/microsoft/TypeScript/pull/52170" target="_blank" rel="noopener noreferrer">Identifier Size Reduction<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://github.com/microsoft/TypeScript/pull/52382" target="_blank" rel="noopener noreferrer">Printer Caching<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://github.com/microsoft/TypeScript/issues/52924" target="_blank" rel="noopener noreferrer">Limited Usage of var<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/Typescript-manual/download/zh/release-notes/typescript-5.1.html" class="prev">
        TypeScript 5.1
      </a></span> <span class="next"><a href="/Typescript-manual/download/zh/release-notes/typescript-4.9.html">
        TypeScript 4.9
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/Typescript-manual/assets/js/app.1593970b.js" defer></script><script src="/Typescript-manual/assets/js/2.f0d70486.js" defer></script><script src="/Typescript-manual/assets/js/1.93812fe5.js" defer></script><script src="/Typescript-manual/assets/js/160.c6a27367.js" defer></script>
  </body>
</html>
